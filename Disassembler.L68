00001000 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 6/3/2019 2:49:35 PM

00000000                             1  *-----------------------------------------------------------
00000000                             2  * Title      :
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------
00000000                             7          INCLUDE TestOps.X68
00006000                             8      ORG    $6000
00006000                             9  
00006000  7001                      10      MOVEQ   #1,D0
00006002  7201                      11      MOVEQ   #1,D1
00006004  7401                      12      MOVEQ   #1,D2
00006006  7601                      13      MOVEQ   #1,D3
00006008  7801                      14      MOVEQ   #1,D4
0000600A  7A01                      15      MOVEQ   #1,D5
0000600C  7002                      16      MOVEQ   #2,D0
0000600E  7008                      17      MOVEQ   #8,D0
00006010  70F8                      18      MOVEQ   #-8,D0
00006012  707F                      19      MOVEQ   #127,D0
00006012  707F                      20  -------------------- end include --------------------
00006014                            21          INCLUDE MOVEM.X68
00003D60                            22      ORG    $3D60
00003D60                            23  
00003D60                            24  IF_MOVEM
00003D60  360C                      25      MOVE.W  A4,D3   
00003D62  C67C FF80                 26      AND.W   #$FF80,D3
00003D66                            27      
00003D66  B67C 4A80                 28      CMP.W   #$4A80,D3
00003D6A  6700 034A                 29      BEQ     IF_MOVEM_TO_ADDRESS
00003D6E                            30      
00003D6E  B67C 4C80                 31      CMP.W   #$4C80,D3
00003D72  6700 0006                 32      BEQ     IF_MOVEM_TO_REGISTER
00003D76                            33      
00003D76  6000 D352                 34      BRA     IF_INVALID_OP
00003D7A                            35      
00003D7A                            36  IF_MOVEM_TO_REGISTER
00003D7A  43F9 0000114A             37      LEA     MOVEM_OUTPUT,A1
00003D80  103C 000E                 38      MOVE.B  #14,D0
00003D84  4E4F                      39      TRAP    #15
00003D86                            40  
00003D86  360C                      41      MOVE.W  A4,D3   
00003D88  C67C 0080                 42      AND.W   #$0080,D3
00003D8C                            43      
00003D8C  B67C 0080                 44      CMP.W   #$0080,D3   
00003D90  6700 0040                 45      BEQ     LONG_FOR_TO_REGISTER
00003D94                            46      
00003D94  6000 0002                 47      BRA     WORD_FOR_TO_REGISTER
00003D98                            48  
00003D98                            49  WORD_FOR_TO_REGISTER
00003D98  43F9 00001180             50      LEA     W_OUTPUT,A1
00003D9E  103C 000E                 51      MOVE.B  #14,D0
00003DA2  4E4F                      52      TRAP    #15
00003DA4                            53      
00003DA4  544A                      54      ADDQ    #2,A2
00003DA6  3A52                      55      MOVE.W  (A2),A5
00003DA8                            56      
00003DA8  6100 0062                 57      BSR     DISPLAY_EA_TO_REGISTER
00003DAC                            58      
00003DAC  123C 002C                 59      MOVE.B  #COMMA,D1
00003DB0  103C 0006                 60      MOVE.B  #6,D0
00003DB4  4E4F                      61      TRAP    #15
00003DB6                            62  
00003DB6  2C7C 00000000             63      MOVE.L  #0,A6
00003DBC  360D                      64      MOVE.W  A5,D3
00003DBE  380D                      65      MOVE.W  A5,D4
00003DC0                            66      
00003DC0  B6BC 00000000             67      CMP.L   #0,D3
00003DC6  6700 D302                 68      BEQ     IF_INVALID_OP
00003DCA                            69      
00003DCA  6100 006A                 70      BSR     PARSE_MASK
00003DCE  6000 D30A                 71      BRA     ITERATE
00003DD2                            72  
00003DD2                            73  LONG_FOR_TO_REGISTER
00003DD2  43F9 00001184             74      LEA     L_OUTPUT,A1
00003DD8  103C 000E                 75      MOVE.B  #14,D0
00003DDC  4E4F                      76      TRAP    #15
00003DDE                            77      
00003DDE  544A                      78      ADDQ    #2,A2
00003DE0  3A52                      79      MOVE.W  (A2),A5
00003DE2                            80      
00003DE2  6100 0028                 81      BSR     DISPLAY_EA_TO_REGISTER
00003DE6                            82      
00003DE6  123C 002C                 83      MOVE.B  #COMMA,D1
00003DEA  103C 0006                 84      MOVE.B  #6,D0
00003DEE  4E4F                      85      TRAP    #15
00003DF0                            86  
00003DF0  2C7C 00000000             87      MOVE.L  #0,A6
00003DF6  360D                      88      MOVE.W  A5,D3
00003DF8  380D                      89      MOVE.W  A5,D4
00003DFA                            90      
00003DFA  B6BC 00000000             91      CMP.L   #0,D3
00003E00  6700 D2C8                 92      BEQ     IF_INVALID_OP
00003E04                            93      
00003E04  6100 0030                 94      BSR     PARSE_MASK
00003E08  6000 D2D0                 95      BRA     ITERATE
00003E0C                            96      
00003E0C                            97  DISPLAY_EA_TO_REGISTER
00003E0C  360C                      98      MOVE.W  A4,D3   
00003E0E  C67C 003A                 99      AND.W   #$003A,D3
00003E12  E68B                     100      LSR.L   #3,D3
00003E14                           101      
00003E14  380C                     102      MOVE.W  A4,D4   
00003E16  C87C 0007                103      AND.W   #$0007,D4
00003E1A                           104      
00003E1A  B67C 0002                105      CMP.W   #%010,D3
00003E1E  6700 DB2C                106      BEQ     DISPLAY_An_ADDRESS_ea
00003E22                           107      
00003E22  B67C 0003                108      CMP.W   #%011,D3
00003E26  6700 DB50                109      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
00003E2A                           110      
00003E2A  B67C 0007                111      CMP.W   #%111,D3
00003E2E  6700 EBB4                112      BEQ     GET_WORD_OR_LONG
00003E32                           113      
00003E32  6000 D296                114      BRA     IF_INVALID_OP
00003E36                           115      
00003E36                           116  PARSE_MASK
00003E36  BDFC 00000010            117      CMP.L   #16,A6
00003E3C  6700 0014                118      BEQ     END_PARSER
00003E40                           119  
00003E40  C6BC 00000001            120      AND.L   #$00000001,D3
00003E46                           121      
00003E46  B67C 0001                122      CMP.W   #%1,D3
00003E4A  6700 0008                123      BEQ     DISPLAY_REG
00003E4E                           124      
00003E4E  6000 0226                125      BRA     ITERATE_MASK
00003E52                           126      
00003E52                           127  END_PARSER
00003E52  4E75                     128      RTS
00003E54                           129      
00003E54                           130  DISPLAY_REG
00003E54  BCFC 0000                131      CMP.W   #$0,A6
00003E58  6700 007E                132      BEQ     DISPLAY_D0
00003E5C                           133      
00003E5C  BCFC 0001                134      CMP.W   #$1,A6
00003E60  6700 0090                135      BEQ     DISPLAY_D1
00003E64                           136      
00003E64  BCFC 0002                137      CMP.W   #$2,A6
00003E68  6700 00A2                138      BEQ     DISPLAY_D2
00003E6C                           139      
00003E6C  BCFC 0003                140      CMP.W   #$3,A6
00003E70  6700 00B4                141      BEQ     DISPLAY_D3
00003E74                           142      
00003E74  BCFC 0004                143      CMP.W   #$4,A6
00003E78  6700 00C6                144      BEQ     DISPLAY_D4
00003E7C                           145      
00003E7C  BCFC 0005                146      CMP.W   #$5,A6
00003E80  6700 00D8                147      BEQ     DISPLAY_D5
00003E84                           148      
00003E84  BCFC 0006                149      CMP.W   #$6,A6
00003E88  6700 00EA                150      BEQ     DISPLAY_D6
00003E8C                           151      
00003E8C  BCFC 0007                152      CMP.W   #$7,A6
00003E90  6700 00FC                153      BEQ     DISPLAY_D7
00003E94                           154      
00003E94  BCFC 0008                155      CMP.W   #$8,A6
00003E98  6700 010E                156      BEQ     DISPLAY_A0
00003E9C                           157      
00003E9C  BCFC 0009                158      CMP.W   #$9,A6
00003EA0  6700 0120                159      BEQ     DISPLAY_A1
00003EA4                           160      
00003EA4  BCFC 000A                161      CMP.W   #$A,A6
00003EA8  6700 0132                162      BEQ     DISPLAY_A2
00003EAC                           163      
00003EAC  BCFC 000B                164      CMP.W   #$B,A6
00003EB0  6700 0144                165      BEQ     DISPLAY_A3
00003EB4                           166      
00003EB4  BCFC 000C                167      CMP.W   #$C,A6
00003EB8  6700 0156                168      BEQ     DISPLAY_A4
00003EBC                           169      
00003EBC  BCFC 000D                170      CMP.W   #$D,A6
00003EC0  6700 0168                171      BEQ     DISPLAY_A5
00003EC4                           172      
00003EC4  BCFC 000E                173      CMP.W   #$E,A6
00003EC8  6700 017A                174      BEQ     DISPLAY_A6
00003ECC                           175      
00003ECC  BCFC 000F                176      CMP.W   #$F,A6
00003ED0  6700 018C                177      BEQ     DISPLAY_A7
00003ED4                           178      
00003ED4  6000 D1F4                179      BRA     IF_INVALID_OP
00003ED8                           180  
00003ED8                           181  DISPLAY_D0
00003ED8  123C 0044                182      MOVE.B  #D,D1
00003EDC  103C 0006                183      MOVE.B  #6,D0
00003EE0  4E4F                     184      TRAP    #15
00003EE2                           185      
00003EE2  143C 0010                186      MOVE.B  #16,D2
00003EE6  103C 000F                187      MOVE.B  #15,D0
00003EEA  7200                     188      MOVE.L  #0,D1
00003EEC  4E4F                     189      TRAP    #15
00003EEE                           190      
00003EEE  6000 0186                191      BRA     ITERATE_MASK
00003EF2                           192  
00003EF2                           193  DISPLAY_D1
00003EF2  123C 0044                194      MOVE.B  #D,D1
00003EF6  103C 0006                195      MOVE.B  #6,D0
00003EFA  4E4F                     196      TRAP    #15
00003EFC                           197      
00003EFC  143C 0010                198      MOVE.B  #16,D2
00003F00  103C 000F                199      MOVE.B  #15,D0
00003F04  7201                     200      MOVE.L  #1,D1
00003F06  4E4F                     201      TRAP    #15
00003F08                           202      
00003F08  6000 016C                203      BRA     ITERATE_MASK
00003F0C                           204  
00003F0C                           205  DISPLAY_D2
00003F0C  123C 0044                206      MOVE.B  #D,D1
00003F10  103C 0006                207      MOVE.B  #6,D0
00003F14  4E4F                     208      TRAP    #15
00003F16                           209      
00003F16  143C 0010                210      MOVE.B  #16,D2
00003F1A  103C 000F                211      MOVE.B  #15,D0
00003F1E  7202                     212      MOVE.L  #2,D1
00003F20  4E4F                     213      TRAP    #15
00003F22                           214      
00003F22  6000 0152                215      BRA     ITERATE_MASK
00003F26                           216  
00003F26                           217  DISPLAY_D3
00003F26  123C 0044                218      MOVE.B  #D,D1
00003F2A  103C 0006                219      MOVE.B  #6,D0
00003F2E  4E4F                     220      TRAP    #15
00003F30                           221      
00003F30  143C 0010                222      MOVE.B  #16,D2
00003F34  103C 000F                223      MOVE.B  #15,D0
00003F38  7203                     224      MOVE.L  #3,D1
00003F3A  4E4F                     225      TRAP    #15
00003F3C                           226      
00003F3C  6000 0138                227      BRA     ITERATE_MASK
00003F40                           228  
00003F40                           229  DISPLAY_D4
00003F40  123C 0044                230      MOVE.B  #D,D1
00003F44  103C 0006                231      MOVE.B  #6,D0
00003F48  4E4F                     232      TRAP    #15
00003F4A                           233      
00003F4A  143C 0010                234      MOVE.B  #16,D2
00003F4E  103C 000F                235      MOVE.B  #15,D0
00003F52  7204                     236      MOVE.L  #4,D1
00003F54  4E4F                     237      TRAP    #15
00003F56                           238      
00003F56  6000 011E                239      BRA     ITERATE_MASK
00003F5A                           240  
00003F5A                           241  DISPLAY_D5
00003F5A  123C 0044                242      MOVE.B  #D,D1
00003F5E  103C 0006                243      MOVE.B  #6,D0
00003F62  4E4F                     244      TRAP    #15
00003F64                           245      
00003F64  143C 0010                246      MOVE.B  #16,D2
00003F68  103C 000F                247      MOVE.B  #15,D0
00003F6C  7205                     248      MOVE.L  #5,D1
00003F6E  4E4F                     249      TRAP    #15
00003F70                           250      
00003F70  6000 0104                251      BRA     ITERATE_MASK
00003F74                           252  
00003F74                           253  DISPLAY_D6  
00003F74  123C 0044                254      MOVE.B  #D,D1
00003F78  103C 0006                255      MOVE.B  #6,D0
00003F7C  4E4F                     256      TRAP    #15
00003F7E                           257      
00003F7E  143C 0010                258      MOVE.B  #16,D2
00003F82  103C 000F                259      MOVE.B  #15,D0
00003F86  7206                     260      MOVE.L  #6,D1
00003F88  4E4F                     261      TRAP    #15
00003F8A                           262      
00003F8A  6000 00EA                263      BRA     ITERATE_MASK
00003F8E                           264  
00003F8E                           265  DISPLAY_D7
00003F8E  123C 0044                266      MOVE.B  #D,D1
00003F92  103C 0006                267      MOVE.B  #6,D0
00003F96  4E4F                     268      TRAP    #15
00003F98                           269      
00003F98  143C 0010                270      MOVE.B  #16,D2
00003F9C  103C 000F                271      MOVE.B  #15,D0
00003FA0  7207                     272      MOVE.L  #7,D1
00003FA2  4E4F                     273      TRAP    #15
00003FA4                           274      
00003FA4  6000 00D0                275      BRA     ITERATE_MASK
00003FA8                           276  
00003FA8                           277  DISPLAY_A0
00003FA8  123C 0041                278      MOVE.B  #A,D1
00003FAC  103C 0006                279      MOVE.B  #6,D0
00003FB0  4E4F                     280      TRAP    #15
00003FB2                           281      
00003FB2  143C 0010                282      MOVE.B  #16,D2
00003FB6  103C 000F                283      MOVE.B  #15,D0
00003FBA  7200                     284      MOVE.L  #0,D1
00003FBC  4E4F                     285      TRAP    #15
00003FBE                           286      
00003FBE  6000 00B6                287      BRA     ITERATE_MASK
00003FC2                           288  
00003FC2                           289  DISPLAY_A1
00003FC2  123C 0044                290      MOVE.B  #D,D1
00003FC6  103C 0006                291      MOVE.B  #6,D0
00003FCA  4E4F                     292      TRAP    #15
00003FCC                           293      
00003FCC  143C 0010                294      MOVE.B  #16,D2
00003FD0  103C 000F                295      MOVE.B  #15,D0
00003FD4  7201                     296      MOVE.L  #1,D1
00003FD6  4E4F                     297      TRAP    #15
00003FD8                           298      
00003FD8  6000 009C                299      BRA     ITERATE_MASK
00003FDC                           300  
00003FDC                           301  DISPLAY_A2
00003FDC  123C 0041                302      MOVE.B  #A,D1
00003FE0  103C 0006                303      MOVE.B  #6,D0
00003FE4  4E4F                     304      TRAP    #15
00003FE6                           305      
00003FE6  143C 0010                306      MOVE.B  #16,D2
00003FEA  103C 000F                307      MOVE.B  #15,D0
00003FEE  7202                     308      MOVE.L  #2,D1
00003FF0  4E4F                     309      TRAP    #15
00003FF2                           310      
00003FF2  6000 0082                311      BRA     ITERATE_MASK
00003FF6                           312  
00003FF6                           313  DISPLAY_A3
00003FF6  123C 0041                314      MOVE.B  #A,D1
00003FFA  103C 0006                315      MOVE.B  #6,D0
00003FFE  4E4F                     316      TRAP    #15
00004000                           317      
00004000  143C 0010                318      MOVE.B  #16,D2
00004004  103C 000F                319      MOVE.B  #15,D0
00004008  7203                     320      MOVE.L  #3,D1
0000400A  4E4F                     321      TRAP    #15
0000400C                           322      
0000400C  6000 0068                323      BRA     ITERATE_MASK
00004010                           324  
00004010                           325  DISPLAY_A4
00004010  123C 0041                326      MOVE.B  #A,D1
00004014  103C 0006                327      MOVE.B  #6,D0
00004018  4E4F                     328      TRAP    #15
0000401A                           329      
0000401A  143C 0010                330      MOVE.B  #16,D2
0000401E  103C 000F                331      MOVE.B  #15,D0
00004022  7204                     332      MOVE.L  #4,D1
00004024  4E4F                     333      TRAP    #15
00004026                           334      
00004026  6000 004E                335      BRA     ITERATE_MASK
0000402A                           336  
0000402A                           337  DISPLAY_A5   
0000402A  123C 0041                338      MOVE.B  #A,D1
0000402E  103C 0006                339      MOVE.B  #6,D0
00004032  4E4F                     340      TRAP    #15
00004034                           341      
00004034  143C 0010                342      MOVE.B  #16,D2
00004038  103C 000F                343      MOVE.B  #15,D0
0000403C  7205                     344      MOVE.L  #5,D1
0000403E  4E4F                     345      TRAP    #15
00004040                           346      
00004040  6000 0034                347      BRA     ITERATE_MASK
00004044                           348  
00004044                           349  DISPLAY_A6
00004044  123C 0041                350      MOVE.B  #A,D1
00004048  103C 0006                351      MOVE.B  #6,D0
0000404C  4E4F                     352      TRAP    #15
0000404E                           353      
0000404E  143C 0010                354      MOVE.B  #16,D2
00004052  103C 000F                355      MOVE.B  #15,D0
00004056  7206                     356      MOVE.L  #6,D1
00004058  4E4F                     357      TRAP    #15
0000405A                           358      
0000405A  6000 001A                359      BRA     ITERATE_MASK
0000405E                           360  
0000405E                           361  DISPLAY_A7
0000405E  123C 0041                362      MOVE.B  #A,D1
00004062  103C 0006                363      MOVE.B  #6,D0
00004066  4E4F                     364      TRAP    #15
00004068                           365      
00004068  143C 0010                366      MOVE.B  #16,D2
0000406C  103C 000F                367      MOVE.B  #15,D0
00004070  7207                     368      MOVE.L  #7,D1
00004072  4E4F                     369      TRAP    #15
00004074                           370      
00004074  4E75                     371      RTS
00004076                           372  
00004076                           373  ITERATE_MASK
00004076  6100 0324                374      BSR     IF_DRAW_SLASH 
0000407A                           375  
0000407A  524E                     376      ADDQ    #1,A6
0000407C  E24C                     377      LSR.W   #1,D4
0000407E                           378      
0000407E  3604                     379      MOVE.W  D4,D3
00004080                           380      
00004080  BCFC 000F                381      CMP.W   #$F,A6
00004084  6E00 FDCC                382      BGT     END_PARSER
00004088                           383      
00004088  6000 FDAC                384      BRA     PARSE_MASK
0000408C                           385      
0000408C                           386  DISPLAY_EA_TO_ADDRESS
0000408C  360C                     387      MOVE.W  A4,D3   
0000408E  C67C 003A                388      AND.W   #$003A,D3
00004092  E68B                     389      LSR.L   #3,D3
00004094                           390      
00004094  380C                     391      MOVE.W  A4,D4   
00004096  C87C 0007                392      AND.W   #$0007,D4
0000409A                           393      
0000409A  B67C 0002                394      CMP.W   #%010,D3
0000409E  6700 D8AC                395      BEQ     DISPLAY_An_ADDRESS_ea
000040A2                           396      
000040A2  B67C 0004                397      CMP.W   #%100,D3
000040A6  6700 D906                398      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
000040AA                           399      
000040AA  B67C 0007                400      CMP.W   #%111,D3
000040AE  6700 E934                401      BEQ     GET_WORD_OR_LONG
000040B2                           402      
000040B2  6000 D016                403      BRA     IF_INVALID_OP
000040B6                           404      
000040B6                           405  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000040B6                           406  IF_MOVEM_TO_ADDRESS
000040B6  7A00                     407      MOVE.L  #0,D5
000040B8                           408  
000040B8  43F9 0000114A            409      LEA     MOVEM_OUTPUT,A1
000040BE  103C 000E                410      MOVE.B  #14,D0
000040C2  4E4F                     411      TRAP    #15
000040C4                           412  
000040C4  360C                     413      MOVE.W  A4,D3   
000040C6  C67C 0080                414      AND.W   #$0080,D3
000040CA                           415      
000040CA  B67C 0080                416      CMP.W   #$0080,D3   
000040CE  6700 0026                417      BEQ     LONG_FOR_TO_ADDRESS
000040D2                           418      
000040D2  6000 0002                419      BRA     WORD_FOR_TO_ADDRESS
000040D6                           420  
000040D6                           421  WORD_FOR_TO_ADDRESS
000040D6  43F9 00001180            422      LEA     W_OUTPUT,A1
000040DC  103C 000E                423      MOVE.B  #14,D0
000040E0  4E4F                     424      TRAP    #15
000040E2                           425      
000040E2  6100 0034                426      BSR     GET_MASK_ADDRESS
000040E6                           427      
000040E6  123C 002C                428      MOVE.B  #COMMA,D1
000040EA  103C 0006                429      MOVE.B  #6,D0
000040EE  4E4F                     430      TRAP    #15
000040F0                           431  
000040F0  619A                     432      BSR     DISPLAY_EA_TO_ADDRESS
000040F2                           433  
000040F2  6000 CFE6                434      BRA     ITERATE
000040F6                           435  
000040F6                           436  LONG_FOR_TO_ADDRESS
000040F6  43F9 00001184            437      LEA     L_OUTPUT,A1
000040FC  103C 000E                438      MOVE.B  #14,D0
00004100  4E4F                     439      TRAP    #15
00004102                           440      
00004102  6100 0014                441      BSR     GET_MASK_ADDRESS
00004106                           442      
00004106  123C 002C                443      MOVE.B  #COMMA,D1
0000410A  103C 0006                444      MOVE.B  #6,D0
0000410E  4E4F                     445      TRAP    #15
00004110                           446  
00004110  6100 FF7A                447      BSR     DISPLAY_EA_TO_ADDRESS
00004114                           448  
00004114  6000 CFC4                449      BRA     ITERATE
00004118                           450      
00004118                           451  
00004118                           452  GET_MASK_ADDRESS    
00004118  360C                     453      MOVE.W  A4,D3   
0000411A  C67C 003A                454      AND.W   #$003A,D3
0000411E  E68B                     455      LSR.L   #3,D3
00004120                           456      
00004120  544A                     457      ADDQ    #2,A2
00004122  3A52                     458      MOVE.W  (A2),A5
00004124                           459      
00004124  B67C 0004                460      CMP.W   #%100,D3
00004128  6000 0006                461      BRA     LOAD_MASK_ADDRESS    
0000412C                           462      
0000412C  6000 FD08                463      BRA     PARSE_MASK
00004130                           464      
00004130                           465  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00004130                           466  LOAD_MASK_ADDRESS
00004130  360D                     467      MOVE.W  A5,D3
00004132  380D                     468      MOVE.W  A5,D4
00004134  2C7C 00000000            469      MOVE.L  #0,A6
0000413A                           470      
0000413A  B6BC 00000000            471      CMP.L   #0,D3
00004140  6700 CF88                472      BEQ     IF_INVALID_OP
00004144                           473      
00004144  6000 0002                474      BRA     PARSE_MASK_ADDRESS
00004148                           475      
00004148                           476  PARSE_MASK_ADDRESS
00004148  BDFC 00000010            477      CMP.L   #16,A6
0000414E  6700 FD02                478      BEQ     END_PARSER
00004152                           479  
00004152  C6BC 00008000            480      AND.L   #$00008000,D3
00004158                           481      
00004158  B67C 0001                482      CMP.W   #%1,D3
0000415C  6700 0006                483      BEQ     DISPLAY_REG_ADDRESS
00004160                           484      
00004160  6000 0224                485      BRA     ITERATE_MASK_ADDRESS
00004164                           486      
00004164                           487  DISPLAY_REG_ADDRESS
00004164  BCFC 0000                488      CMP.W   #$0,A6
00004168  6700 007E                489      BEQ     DISPLAY_D0_ADDRESS
0000416C                           490      
0000416C  BCFC 0001                491      CMP.W   #$1,A6
00004170  6700 0090                492      BEQ     DISPLAY_D1_ADDRESS
00004174                           493      
00004174  BCFC 0002                494      CMP.W   #$2,A6
00004178  6700 00A2                495      BEQ     DISPLAY_D2_ADDRESS
0000417C                           496      
0000417C  BCFC 0003                497      CMP.W   #$3,A6
00004180  6700 00B4                498      BEQ     DISPLAY_D3_ADDRESS
00004184                           499      
00004184  BCFC 0004                500      CMP.W   #$4,A6
00004188  6700 00C6                501      BEQ     DISPLAY_D4_ADDRESS
0000418C                           502      
0000418C  BCFC 0005                503      CMP.W   #$5,A6
00004190  6700 00D8                504      BEQ     DISPLAY_D5_ADDRESS
00004194                           505      
00004194  BCFC 0006                506      CMP.W   #$6,A6
00004198  6700 00EA                507      BEQ     DISPLAY_D6_ADDRESS
0000419C                           508      
0000419C  BCFC 0007                509      CMP.W   #$7,A6
000041A0  6700 00FC                510      BEQ     DISPLAY_D7_ADDRESS
000041A4                           511      
000041A4  BCFC 0008                512      CMP.W   #$8,A6
000041A8  6700 010E                513      BEQ     DISPLAY_A0_ADDRESS
000041AC                           514      
000041AC  BCFC 0009                515      CMP.W   #$9,A6
000041B0  6700 0120                516      BEQ     DISPLAY_A1_ADDRESS
000041B4                           517      
000041B4  BCFC 000A                518      CMP.W   #$A,A6
000041B8  6700 0132                519      BEQ     DISPLAY_A2_ADDRESS
000041BC                           520      
000041BC  BCFC 000B                521      CMP.W   #$B,A6
000041C0  6700 0144                522      BEQ     DISPLAY_A3_ADDRESS
000041C4                           523      
000041C4  BCFC 000C                524      CMP.W   #$C,A6
000041C8  6700 0156                525      BEQ     DISPLAY_A4_ADDRESS
000041CC                           526      
000041CC  BCFC 000D                527      CMP.W   #$D,A6
000041D0  6700 0168                528      BEQ     DISPLAY_A5_ADDRESS
000041D4                           529      
000041D4  BCFC 000E                530      CMP.W   #$E,A6
000041D8  6700 017A                531      BEQ     DISPLAY_A6_ADDRESS
000041DC                           532      
000041DC  BCFC 000F                533      CMP.W   #$F,A6
000041E0  6700 018C                534      BEQ     DISPLAY_A7_ADDRESS
000041E4                           535      
000041E4  6000 CEE4                536      BRA     IF_INVALID_OP
000041E8                           537  
000041E8                           538  DISPLAY_D0_ADDRESS
000041E8  123C 0044                539      MOVE.B  #D,D1
000041EC  103C 0006                540      MOVE.B  #6,D0
000041F0  4E4F                     541      TRAP    #15
000041F2                           542      
000041F2  143C 0010                543      MOVE.B  #16,D2
000041F6  103C 000F                544      MOVE.B  #15,D0
000041FA  7200                     545      MOVE.L  #0,D1
000041FC  4E4F                     546      TRAP    #15
000041FE                           547      
000041FE  6000 0186                548      BRA     ITERATE_MASK_ADDRESS
00004202                           549  
00004202                           550  DISPLAY_D1_ADDRESS
00004202  123C 0044                551      MOVE.B  #D,D1
00004206  103C 0006                552      MOVE.B  #6,D0
0000420A  4E4F                     553      TRAP    #15
0000420C                           554      
0000420C  143C 0010                555      MOVE.B  #16,D2
00004210  103C 000F                556      MOVE.B  #15,D0
00004214  7201                     557      MOVE.L  #1,D1
00004216  4E4F                     558      TRAP    #15
00004218                           559      
00004218  6000 016C                560      BRA     ITERATE_MASK_ADDRESS
0000421C                           561  
0000421C                           562  DISPLAY_D2_ADDRESS
0000421C  123C 0044                563      MOVE.B  #D,D1
00004220  103C 0006                564      MOVE.B  #6,D0
00004224  4E4F                     565      TRAP    #15
00004226                           566      
00004226  143C 0010                567      MOVE.B  #16,D2
0000422A  103C 000F                568      MOVE.B  #15,D0
0000422E  7202                     569      MOVE.L  #2,D1
00004230  4E4F                     570      TRAP    #15
00004232                           571      
00004232  6000 0152                572      BRA     ITERATE_MASK_ADDRESS
00004236                           573  
00004236                           574  DISPLAY_D3_ADDRESS
00004236  123C 0044                575      MOVE.B  #D,D1
0000423A  103C 0006                576      MOVE.B  #6,D0
0000423E  4E4F                     577      TRAP    #15
00004240                           578      
00004240  143C 0010                579      MOVE.B  #16,D2
00004244  103C 000F                580      MOVE.B  #15,D0
00004248  7203                     581      MOVE.L  #3,D1
0000424A  4E4F                     582      TRAP    #15
0000424C                           583      
0000424C  6000 0138                584      BRA     ITERATE_MASK_ADDRESS
00004250                           585  
00004250                           586  DISPLAY_D4_ADDRESS
00004250  123C 0044                587      MOVE.B  #D,D1
00004254  103C 0006                588      MOVE.B  #6,D0
00004258  4E4F                     589      TRAP    #15
0000425A                           590      
0000425A  143C 0010                591      MOVE.B  #16,D2
0000425E  103C 000F                592      MOVE.B  #15,D0
00004262  7204                     593      MOVE.L  #4,D1
00004264  4E4F                     594      TRAP    #15
00004266                           595      
00004266  6000 011E                596      BRA     ITERATE_MASK_ADDRESS
0000426A                           597  
0000426A                           598  DISPLAY_D5_ADDRESS
0000426A  123C 0044                599      MOVE.B  #D,D1
0000426E  103C 0006                600      MOVE.B  #6,D0
00004272  4E4F                     601      TRAP    #15
00004274                           602      
00004274  143C 0010                603      MOVE.B  #16,D2
00004278  103C 000F                604      MOVE.B  #15,D0
0000427C  7205                     605      MOVE.L  #5,D1
0000427E  4E4F                     606      TRAP    #15
00004280                           607      
00004280  6000 0104                608      BRA     ITERATE_MASK_ADDRESS
00004284                           609  
00004284                           610  DISPLAY_D6_ADDRESS
00004284  123C 0044                611      MOVE.B  #D,D1
00004288  103C 0006                612      MOVE.B  #6,D0
0000428C  4E4F                     613      TRAP    #15
0000428E                           614      
0000428E  143C 0010                615      MOVE.B  #16,D2
00004292  103C 000F                616      MOVE.B  #15,D0
00004296  7206                     617      MOVE.L  #6,D1
00004298  4E4F                     618      TRAP    #15
0000429A                           619      
0000429A  6000 00EA                620      BRA     ITERATE_MASK_ADDRESS
0000429E                           621  
0000429E                           622  DISPLAY_D7_ADDRESS
0000429E  123C 0044                623      MOVE.B  #D,D1
000042A2  103C 0006                624      MOVE.B  #6,D0
000042A6  4E4F                     625      TRAP    #15
000042A8                           626      
000042A8  143C 0010                627      MOVE.B  #16,D2
000042AC  103C 000F                628      MOVE.B  #15,D0
000042B0  7207                     629      MOVE.L  #7,D1
000042B2  4E4F                     630      TRAP    #15
000042B4                           631      
000042B4  6000 00D0                632      BRA     ITERATE_MASK_ADDRESS
000042B8                           633  
000042B8                           634  DISPLAY_A0_ADDRESS
000042B8  123C 0041                635      MOVE.B  #A,D1
000042BC  103C 0006                636      MOVE.B  #6,D0
000042C0  4E4F                     637      TRAP    #15
000042C2                           638      
000042C2  143C 0010                639      MOVE.B  #16,D2
000042C6  103C 000F                640      MOVE.B  #15,D0
000042CA  7200                     641      MOVE.L  #0,D1
000042CC  4E4F                     642      TRAP    #15
000042CE                           643      
000042CE  6000 00B6                644      BRA     ITERATE_MASK_ADDRESS
000042D2                           645  
000042D2                           646  DISPLAY_A1_ADDRESS
000042D2  123C 0044                647      MOVE.B  #D,D1
000042D6  103C 0006                648      MOVE.B  #6,D0
000042DA  4E4F                     649      TRAP    #15
000042DC                           650      
000042DC  143C 0010                651      MOVE.B  #16,D2
000042E0  103C 000F                652      MOVE.B  #15,D0
000042E4  7201                     653      MOVE.L  #1,D1
000042E6  4E4F                     654      TRAP    #15
000042E8                           655      
000042E8  6000 009C                656      BRA     ITERATE_MASK_ADDRESS
000042EC                           657  
000042EC                           658  DISPLAY_A2_ADDRESS
000042EC  123C 0041                659      MOVE.B  #A,D1
000042F0  103C 0006                660      MOVE.B  #6,D0
000042F4  4E4F                     661      TRAP    #15
000042F6                           662      
000042F6  143C 0010                663      MOVE.B  #16,D2
000042FA  103C 000F                664      MOVE.B  #15,D0
000042FE  7202                     665      MOVE.L  #2,D1
00004300  4E4F                     666      TRAP    #15
00004302                           667      
00004302  6000 0082                668      BRA     ITERATE_MASK_ADDRESS
00004306                           669  
00004306                           670  DISPLAY_A3_ADDRESS
00004306  123C 0041                671      MOVE.B  #A,D1
0000430A  103C 0006                672      MOVE.B  #6,D0
0000430E  4E4F                     673      TRAP    #15
00004310                           674      
00004310  143C 0010                675      MOVE.B  #16,D2
00004314  103C 000F                676      MOVE.B  #15,D0
00004318  7203                     677      MOVE.L  #3,D1
0000431A  4E4F                     678      TRAP    #15
0000431C                           679      
0000431C  6000 0068                680      BRA     ITERATE_MASK_ADDRESS
00004320                           681  
00004320                           682  DISPLAY_A4_ADDRESS
00004320  123C 0041                683      MOVE.B  #A,D1
00004324  103C 0006                684      MOVE.B  #6,D0
00004328  4E4F                     685      TRAP    #15
0000432A                           686      
0000432A  143C 0010                687      MOVE.B  #16,D2
0000432E  103C 000F                688      MOVE.B  #15,D0
00004332  7204                     689      MOVE.L  #4,D1
00004334  4E4F                     690      TRAP    #15
00004336                           691      
00004336  6000 004E                692      BRA     ITERATE_MASK_ADDRESS
0000433A                           693  
0000433A                           694  DISPLAY_A5_ADDRESS
0000433A  123C 0041                695      MOVE.B  #A,D1
0000433E  103C 0006                696      MOVE.B  #6,D0
00004342  4E4F                     697      TRAP    #15
00004344                           698      
00004344  143C 0010                699      MOVE.B  #16,D2
00004348  103C 000F                700      MOVE.B  #15,D0
0000434C  7205                     701      MOVE.L  #5,D1
0000434E  4E4F                     702      TRAP    #15
00004350                           703      
00004350  6000 0034                704      BRA     ITERATE_MASK_ADDRESS
00004354                           705  
00004354                           706  DISPLAY_A6_ADDRESS
00004354  123C 0041                707      MOVE.B  #A,D1
00004358  103C 0006                708      MOVE.B  #6,D0
0000435C  4E4F                     709      TRAP    #15
0000435E                           710      
0000435E  143C 0010                711      MOVE.B  #16,D2
00004362  103C 000F                712      MOVE.B  #15,D0
00004366  7206                     713      MOVE.L  #6,D1
00004368  4E4F                     714      TRAP    #15
0000436A                           715      
0000436A  6000 001A                716      BRA     ITERATE_MASK_ADDRESS
0000436E                           717  
0000436E                           718  DISPLAY_A7_ADDRESS
0000436E  123C 0041                719      MOVE.B  #A,D1
00004372  103C 0006                720      MOVE.B  #6,D0
00004376  4E4F                     721      TRAP    #15
00004378                           722      
00004378  143C 0010                723      MOVE.B  #16,D2
0000437C  103C 000F                724      MOVE.B  #15,D0
00004380  7207                     725      MOVE.L  #7,D1
00004382  4E4F                     726      TRAP    #15
00004384                           727      
00004384  4E75                     728      RTS
00004386                           729  
00004386                           730  ITERATE_MASK_ADDRESS
00004386  6100 0014                731      BSR     IF_DRAW_SLASH 
0000438A                           732  
0000438A  524E                     733      ADDQ    #1,A6
0000438C  E34C                     734      LSL.W   #1,D4
0000438E                           735      
0000438E  3604                     736      MOVE.W  D4,D3
00004390                           737      
00004390  BCFC 000F                738      CMP.W   #$F,A6
00004394  6E00 FABC                739      BGT     END_PARSER
00004398                           740      
00004398  6000 FDAE                741      BRA     PARSE_MASK_ADDRESS
0000439C                           742      
0000439C                           743  
0000439C                           744      
0000439C                           745  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0000439C                           746  
0000439C                           747  IF_DRAW_SLASH
0000439C  B87C 0000                748      CMP.W   #0,D4
000043A0  6600 0004                749      BNE     IF_DRAW_SLASH_2
000043A4                           750      
000043A4  4E75                     751      RTS
000043A6                           752  
000043A6                           753  IF_DRAW_SLASH_2
000043A6  B67C 0001                754      CMP.W   #1,D3
000043AA  6700 0004                755      BEQ     DRAW_SLASH
000043AE                           756      
000043AE  4E75                     757      RTS
000043B0                           758  
000043B0                           759  DRAW_SLASH
000043B0  123C 002F                760      MOVE.B  #SLASH,D1
000043B4  103C 0006                761      MOVE.B  #6,D0
000043B8  4E4F                     762      TRAP    #15
000043BA                           763      
000043BA  4E75                     764      RTS
000043BC                           765  
000043BC                           766  
000043BC                           767  -------------------- end include --------------------
000043BC                           768          INCLUDE LogicalShift.X68
000028C0                           769      ORG    $28C0
000028C0                           770      
000028C0                           771  IF_LS_CODE
000028C0  360C                     772      MOVE.W  A4,D3   
000028C2  C67C FFC0                773      AND.W   #$FFC0,D3
000028C6                           774      
000028C6                           775      ;Check if address shift, or register shift
000028C6                           776      
000028C6  B67C E4C0                777      CMP.W   #LSR_ADDRESS,D3
000028CA  6700 0064                778      BEQ     IF_LSR_ADDRESS
000028CE                           779      
000028CE  B67C E5C0                780      CMP.W   #LSL_ADDRESS,D3
000028D2  6700 0070                781      BEQ     IF_LSL_ADDRESS
000028D6                           782      
000028D6  B67C E0C0                783      CMP.W   #ASR_ADDRESS,D3
000028DA  6700 007C                784      BEQ     IF_ASR_ADDRESS
000028DE                           785      
000028DE  B67C E1C0                786      CMP.W   #ASL_ADDRESS,D3
000028E2  6700 0088                787      BEQ     IF_ASL_ADDRESS
000028E6                           788      
000028E6  B67C E7C0                789      CMP.W   #ROL_ADDRESS,D3
000028EA  6700 00A8                790      BEQ     IF_ROL_ADDRESS
000028EE                           791      
000028EE  B67C E6C0                792      CMP.W   #ROR_ADDRESS,D3
000028F2  6700 008C                793      BEQ     IF_ROR_ADDRESS
000028F6                           794      
000028F6                           795      ;Check if REGISTER SHIFT
000028F6                           796      
000028F6  360C                     797      MOVE.W  A4,D3   
000028F8  C67C F11A                798      AND.W   #$F11A,D3
000028FC                           799      
000028FC  B67C E01A                800      CMP.W   #LSR_REGISTER,D3
00002900  6700 00F6                801      BEQ     IF_LSR_REGISTER
00002904                           802      
00002904  B67C E11A                803      CMP.W   #LSL_REGISTER,D3
00002908  6700 00FE                804      BEQ     IF_LSL_REGISTER
0000290C                           805      
0000290C  B67C E00A                806      CMP.W   #ASR_REGISTER,D3
00002910  6700 0106                807      BEQ     IF_ASR_REGISTER
00002914                           808      
00002914  B67C E10A                809      CMP.W   #ASL_REGISTER,D3
00002918  6700 010E                810      BEQ     IF_ASL_REGISTER
0000291C                           811      
0000291C  B67C E7C0                812      CMP.W   #ROL_REGISTER,D3
00002920  6700 0126                813      BEQ     IF_ROL_REGISTER
00002924                           814      
00002924  B67C E6C0                815      CMP.W   #ROR_REGISTER,D3
00002928  6700 010E                816      BEQ     IF_ROR_REGISTER
0000292C                           817      
0000292C  6000 E79C                818      BRA     IF_INVALID_OP
00002930                           819      
00002930                           820  IF_LSR_ADDRESS
00002930  43F9 00001164            821      LEA     LSR_OUTPUT,A1
00002936  103C 000E                822      MOVE.B  #14,D0
0000293A  4E4F                     823      TRAP    #15
0000293C                           824      
0000293C  6100 006A                825      BSR     DISPLAY_EFFECTIVE_ADDRESS
00002940  6000 E798                826      BRA     ITERATE
00002944                           827  
00002944                           828  IF_LSL_ADDRESS
00002944  43F9 00001168            829      LEA     LSL_OUTPUT,A1
0000294A  103C 000E                830      MOVE.B  #14,D0
0000294E  4E4F                     831      TRAP    #15
00002950                           832      
00002950  6100 0056                833      BSR     DISPLAY_EFFECTIVE_ADDRESS
00002954  6000 E784                834      BRA     ITERATE
00002958                           835  
00002958                           836  IF_ASR_ADDRESS
00002958  43F9 0000116C            837      LEA     ASR_OUTPUT,A1
0000295E  103C 000E                838      MOVE.B  #14,D0
00002962  4E4F                     839      TRAP    #15
00002964                           840      
00002964  6100 0042                841      BSR     DISPLAY_EFFECTIVE_ADDRESS
00002968  6000 E770                842      BRA     ITERATE
0000296C                           843  
0000296C                           844  IF_ASL_ADDRESS
0000296C  43F9 00001170            845      LEA     ASL_OUTPUT,A1
00002972  103C 000E                846      MOVE.B  #14,D0
00002976  4E4F                     847      TRAP    #15
00002978                           848      
00002978  6100 002E                849      BSR     DISPLAY_EFFECTIVE_ADDRESS
0000297C  6000 E75C                850      BRA     ITERATE
00002980                           851  
00002980                           852  IF_ROR_ADDRESS
00002980  43F9 00001174            853      LEA     ROR_OUTPUT,A1
00002986  103C 000E                854      MOVE.B  #14,D0
0000298A  4E4F                     855      TRAP    #15
0000298C                           856  
0000298C  6100 001A                857      BSR     DISPLAY_EFFECTIVE_ADDRESS
00002990  6000 E748                858      BRA     ITERATE
00002994                           859  
00002994                           860  IF_ROL_ADDRESS
00002994  43F9 00001178            861      LEA     ROL_OUTPUT,A1
0000299A  103C 000E                862      MOVE.B  #14,D0
0000299E  4E4F                     863      TRAP    #15
000029A0                           864  
000029A0  6100 0006                865      BSR     DISPLAY_EFFECTIVE_ADDRESS
000029A4  6000 E734                866      BRA     ITERATE
000029A8                           867  
000029A8                           868  DISPLAY_EFFECTIVE_ADDRESS
000029A8  123C 0020                869      MOVE.B  #SPACE,D1
000029AC  103C 0006                870      MOVE.B  #6,D0
000029B0  4E4F                     871      TRAP    #15
000029B2                           872      
000029B2                           873      ;Get mode
000029B2  360C                     874      MOVE.W  A4,D3   
000029B4  C67C 003A                875      AND.W   #$003A,D3
000029B8  E68B                     876      LSR.L   #3,D3
000029BA                           877      
000029BA  380C                     878      MOVE.W  A4,D4   
000029BC  C87C 0007                879      AND.W   #$0007,D4
000029C0                           880      
000029C0  B67C 0002                881      CMP.W   #%010,D3
000029C4  6700 EF86                882      BEQ     DISPLAY_An_ADDRESS_ea
000029C8                           883      
000029C8  B67C 0003                884      CMP.W   #%011,D3
000029CC  6700 EFAA                885      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
000029D0                           886      
000029D0  B67C 0004                887      CMP.W   #%100,D3
000029D4  6700 EFD8                888      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
000029D8                           889      
000029D8  B67C 0007                890      CMP.W   #%111,D3
000029DC  6700 0006                891      BEQ     GET_WORD_OR_LONG
000029E0                           892      
000029E0  6000 E6E8                893      BRA     IF_INVALID_OP
000029E4                           894      
000029E4                           895  GET_WORD_OR_LONG
000029E4  B87C 0000                896      CMP.W   #%000,D4
000029E8  6700 F016                897      BEQ     DISPLAY_ADDRESS_WORD_ea
000029EC                           898      
000029EC  B87C 0001                899      CMP.W   #%001,D4
000029F0  6700 F02A                900      BEQ     DISPLAY_ADDRESS_LONG_ea
000029F4                           901      
000029F4  6000 E6D4                902      BRA     IF_INVALID_OP    
000029F8                           903      
000029F8                           904  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000029F8                           905  IF_LSR_REGISTER
000029F8  43F9 00001168            906      LEA     LSL_OUTPUT,A1
000029FE  103C 000E                907      MOVE.B  #14,D0
00002A02  4E4F                     908      TRAP    #15
00002A04                           909      
00002A04  6000 0052                910      BRA     GET_SIZE
00002A08                           911  
00002A08                           912  IF_LSL_REGISTER
00002A08  43F9 00001168            913      LEA     LSL_OUTPUT,A1
00002A0E  103C 000E                914      MOVE.B  #14,D0
00002A12  4E4F                     915      TRAP    #15
00002A14                           916  
00002A14  6000 0042                917      BRA     GET_SIZE
00002A18                           918      
00002A18                           919  IF_ASR_REGISTER
00002A18  43F9 0000116C            920      LEA     ASR_OUTPUT,A1
00002A1E  103C 000E                921      MOVE.B  #14,D0
00002A22  4E4F                     922      TRAP    #15
00002A24                           923  
00002A24  6000 0032                924      BRA     GET_SIZE
00002A28                           925  
00002A28                           926  IF_ASL_REGISTER
00002A28  43F9 00001170            927      LEA     ASL_OUTPUT,A1
00002A2E  103C 000E                928      MOVE.B  #14,D0
00002A32  4E4F                     929      TRAP    #15
00002A34                           930      
00002A34  6000 0022                931      BRA     GET_SIZE
00002A38                           932  
00002A38                           933  IF_ROR_REGISTER
00002A38  43F9 00001174            934      LEA     ROR_OUTPUT,A1
00002A3E  103C 000E                935      MOVE.B  #14,D0
00002A42  4E4F                     936      TRAP    #15
00002A44                           937      
00002A44  6000 0012                938      BRA     GET_SIZE
00002A48                           939  
00002A48                           940  IF_ROL_REGISTER
00002A48  43F9 00001178            941      LEA     ROL_OUTPUT,A1
00002A4E  103C 000E                942      MOVE.B  #14,D0
00002A52  4E4F                     943      TRAP    #15
00002A54                           944      
00002A54  6000 0002                945      BRA     GET_SIZE
00002A58                           946      
00002A58                           947  GET_SIZE
00002A58  360C                     948      MOVE.W  A4,D3   
00002A5A  C67C 00C0                949      AND.W   #$00C0,D3
00002A5E                           950      
00002A5E  ED4B                     951      LSL.W   #6,D3
00002A60                           952      
00002A60  B63C 0000                953      CMP.B   #%00,D3
00002A64  6700 0016                954      BEQ     DISPLAY_SIZE_BYTE
00002A68                           955      
00002A68  B63C 0001                956      CMP.B   #%01,D3
00002A6C  6700 001E                957      BEQ     DISPLAY_SIZE_WORD
00002A70                           958      
00002A70  B63C 0002                959      CMP.B   #%10,D3
00002A74  6700 0026                960      BEQ     DISPLAY_SIZE_LONG
00002A78                           961      
00002A78  6000 E650                962      BRA     IF_INVALID_OP
00002A7C                           963      
00002A7C                           964  DISPLAY_SIZE_BYTE
00002A7C  43F9 0000117C            965      LEA     B_OUTPUT,A1
00002A82  103C 000E                966      MOVE.B  #14,D0
00002A86  4E4F                     967      TRAP    #15
00002A88                           968      
00002A88  6000 0022                969      BRA     DETERMINE_SRC
00002A8C                           970  
00002A8C                           971  DISPLAY_SIZE_WORD
00002A8C  43F9 00001180            972      LEA     W_OUTPUT,A1
00002A92  103C 000E                973      MOVE.B  #14,D0
00002A96  4E4F                     974      TRAP    #15
00002A98                           975      
00002A98  6000 0012                976      BRA     DETERMINE_SRC
00002A9C                           977  
00002A9C                           978  DISPLAY_SIZE_LONG
00002A9C  43F9 00001184            979      LEA     L_OUTPUT,A1
00002AA2  103C 000E                980      MOVE.B  #14,D0
00002AA6  4E4F                     981      TRAP    #15
00002AA8                           982      
00002AA8  6000 0002                983      BRA     DETERMINE_SRC
00002AAC                           984      
00002AAC                           985  DETERMINE_SRC
00002AAC  360C                     986      MOVE.W  A4,D3   
00002AAE  C67C 0020                987      AND.W   #$0020,D3
00002AB2                           988      
00002AB2  380C                     989      MOVE.W  A4,D4
00002AB4  C87C 0E00                990      AND.W   #$0E00,D4
00002AB8  EF5C                     991      ROL.W   #7,D4
00002ABA  C8BC FFFFFFFA            992      AND.L   #$FFFFFFFA,D4
00002AC0                           993      
00002AC0  B67C 0020                994      CMP.W   #$0020,D3
00002AC4  6700 0006                995      BEQ     DISPLAY_REGISTER_1
00002AC8                           996      
00002AC8  6000 001C                997      BRA     DISPLAY_NUM
00002ACC                           998      
00002ACC                           999  DISPLAY_REGISTER_1
00002ACC  123C 0044               1000      MOVE.B  #D,D1
00002AD0  103C 0006               1001      MOVE.B  #6,D0
00002AD4  4E4F                    1002      TRAP    #15
00002AD6                          1003      
00002AD6  143C 0010               1004      MOVE.B  #16,D2
00002ADA  103C 000F               1005      MOVE.B  #15,D0
00002ADE  1204                    1006      MOVE.B  D4,D1
00002AE0  4E4F                    1007      TRAP    #15
00002AE2                          1008      
00002AE2  6000 002A               1009      BRA     DISPLAY_REGISTER_2
00002AE6                          1010      
00002AE6                          1011      
00002AE6                          1012  DISPLAY_NUM
00002AE6  123C 0023               1013      MOVE.B  #NUM,D1
00002AEA  103C 0006               1014      MOVE.B  #6,D0
00002AEE  4E4F                    1015      TRAP    #15
00002AF0                          1016      
00002AF0  123C 0024               1017      MOVE.B  #HEX,D1
00002AF4  103C 0006               1018      MOVE.B  #6,D0
00002AF8  4E4F                    1019      TRAP    #15
00002AFA                          1020      
00002AFA  6100 003C               1021      BSR     CHECK_IF_0
00002AFE                          1022      
00002AFE  143C 0010               1023      MOVE.B  #16,D2
00002B02  103C 000F               1024      MOVE.B  #15,D0
00002B06  1204                    1025      MOVE.B  D4,D1
00002B08  4E4F                    1026      TRAP    #15
00002B0A                          1027      
00002B0A  6000 0002               1028      BRA     DISPLAY_REGISTER_2
00002B0E                          1029  
00002B0E                          1030  
00002B0E                          1031  DISPLAY_REGISTER_2
00002B0E  123C 002C               1032      MOVE.B  #COMMA,D1
00002B12  103C 0006               1033      MOVE.B  #6,D0
00002B16  4E4F                    1034      TRAP    #15
00002B18                          1035  
00002B18  123C 0044               1036      MOVE.B  #D,D1
00002B1C  103C 0006               1037      MOVE.B  #6,D0
00002B20  4E4F                    1038      TRAP    #15
00002B22                          1039      
00002B22  320C                    1040      MOVE.W  A4,D1
00002B24  C2BC 00000007           1041      AND.L   #$00000007,D1
00002B2A                          1042      
00002B2A  143C 0010               1043      MOVE.B  #16,D2
00002B2E  103C 000F               1044      MOVE.B  #15,D0
00002B32  4E4F                    1045      TRAP    #15
00002B34                          1046      
00002B34  6000 E5A4               1047      BRA     ITERATE
00002B38                          1048  
00002B38                          1049  ;Subroutine;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002B38                          1050  CHECK_IF_0
00002B38  B83C 0000               1051      CMP.B   #0,D4
00002B3C  6700 0004               1052      BEQ     SET_TO_ZERO
00002B40                          1053      
00002B40  4E75                    1054      RTS
00002B42                          1055      
00002B42                          1056  SET_TO_ZERO
00002B42  7808                    1057      MOVE.L  #8,D4
00002B44  4E75                    1058      RTS
00002B46                          1059     
00002B46                          1060  
00002B46                          1061  
00002B46                          1062  
00002B46                          1063  
00002B46                          1064  
00002B46                          1065  -------------------- end include --------------------
00002B46                          1066          INCLUDE Bcc_BRA.X68
00002080                          1067      ORG    $2080
00002080                          1068  
00002080                          1069  IF_Bcc_BRA
00002080  360C                    1070      MOVE.W  A4,D3   
00002082  C67C FF00               1071      AND.W   #$FF00,D3
00002086                          1072      
00002086  B67C 6000               1073      CMP.W   #$6000,D3
0000208A  6700 001E               1074      BEQ     DISPLAY_BRA
0000208E                          1075      
0000208E  B67C 6000               1076      CMP.W   #$6000,D3
00002092  6700 0028               1077      BEQ     DISPLAY_BGT
00002096                          1078      
00002096  B67C 6000               1079      CMP.W   #$6000,D3
0000209A  6700 0046               1080      BEQ     DISPLAY_BLE
0000209E                          1081      
0000209E  B67C 6000               1082      CMP.W   #$6000,D3
000020A2  6700 0064               1083      BEQ     DISPLAY_BEQ
000020A6                          1084      
000020A6  6000 F022               1085      BRA     IF_INVALID_OP
000020AA                          1086      
000020AA                          1087  DISPLAY_BRA
000020AA  43F9 00001150           1088      LEA     BRA_OUTPUT,A1
000020B0  103C 000E               1089      MOVE.B  #14,D0
000020B4  4E4F                    1090      TRAP    #15
000020B6                          1091  
000020B6  360C                    1092      MOVE.W  A4,D3   
000020B8  C67C 00FF               1093      AND.W   #$00FF,D3
000020BC                          1094     
000020BC                          1095  DISPLAY_BGT
000020BC  43F9 00001155           1096      LEA     BGT_OUTPUT,A1
000020C2  103C 000E               1097      MOVE.B  #14,D0
000020C6  4E4F                    1098      TRAP    #15
000020C8                          1099  
000020C8  360C                    1100      MOVE.W  A4,D3   
000020CA  C67C 00FF               1101      AND.W   #$00FF,D3
000020CE                          1102      
000020CE  B63C 0000               1103      CMP.B   #$00,D3
000020D2  6000 005A               1104      BRA     PARSE_DISPLACEMENT_BYTE
000020D6                          1105      
000020D6  B63C 00FF               1106      CMP.B   #$FF,D3
000020DA  6000 EFEE               1107      BRA     IF_INVALID_OP ;We don't handle 32 bit
000020DE                          1108      
000020DE  6000 0062               1109      BRA     PARSE_DISPLACEMENT_WORD
000020E2                          1110      
000020E2                          1111  DISPLAY_BLE
000020E2  43F9 0000115A           1112      LEA     BLE_OUTPUT,A1
000020E8  103C 000E               1113      MOVE.B  #14,D0
000020EC  4E4F                    1114      TRAP    #15
000020EE                          1115  
000020EE  360C                    1116      MOVE.W  A4,D3   
000020F0  C67C 00FF               1117      AND.W   #$00FF,D3
000020F4                          1118      
000020F4  B63C 0000               1119      CMP.B   #$00,D3
000020F8  6000 0034               1120      BRA     PARSE_DISPLACEMENT_BYTE
000020FC                          1121      
000020FC  B63C 00FF               1122      CMP.B   #$FF,D3
00002100  6000 EFC8               1123      BRA     IF_INVALID_OP ;We don't handle 32 bit
00002104                          1124      
00002104  6000 003C               1125      BRA     PARSE_DISPLACEMENT_WORD
00002108                          1126      
00002108                          1127  DISPLAY_BEQ
00002108  43F9 0000115F           1128      LEA     BEQ_OUTPUT,A1
0000210E  103C 000E               1129      MOVE.B  #14,D0
00002112  4E4F                    1130      TRAP    #15
00002114                          1131  
00002114  360C                    1132      MOVE.W  A4,D3   
00002116  C67C 00FF               1133      AND.W   #$00FF,D3
0000211A                          1134      
0000211A  B63C 0000               1135      CMP.B   #$00,D3
0000211E  6000 0022               1136      BRA     PARSE_DISPLACEMENT_WORD
00002122                          1137      
00002122  B63C 00FF               1138      CMP.B   #$FF,D3
00002126  6000 EFA2               1139      BRA     IF_INVALID_OP ;We don't handle 32 bit
0000212A                          1140      
0000212A  6000 0002               1141      BRA     PARSE_DISPLACEMENT_BYTE
0000212E                          1142      
0000212E                          1143  PARSE_DISPLACEMENT_BYTE
0000212E  7200                    1144      MOVE.L  #$00000000,D1
00002130                          1145  
00002130  C6BC FFFFFF00           1146      AND.L   #$FFFFFF00,D3
00002136  B63C 00A0               1147      CMP.B   #$A0,D3    
0000213A  6C00 001E               1148      BGE     IF_NEGATIVE_BYTE
0000213E                          1149  
0000213E  6000 0032               1150      BRA     DISPLAY_DISPLACEMENT_AS_ADDRESS
00002142                          1151  
00002142                          1152  PARSE_DISPLACEMENT_WORD
00002142  7200                    1153      MOVE.L  #$00000000,D1
00002144                          1154  
00002144  544A                    1155      ADDQ    #2,A2
00002146  3612                    1156      MOVE.W  (A2),D3
00002148                          1157      
00002148  C6BC FFFF0000           1158      AND.L   #$FFFF0000,D3
0000214E  B67C A000               1159      CMP.W   #$A000,D3    
00002152  6C00 0012               1160      BGE     IF_NEGATIVE_WORD
00002156                          1161  
00002156  6000 001A               1162      BRA     DISPLAY_DISPLACEMENT_AS_ADDRESS
0000215A                          1163      
0000215A                          1164  IF_NEGATIVE_BYTE
0000215A  223C FFFFFF00           1165      MOVE.L  #$FFFFFF00,D1
00002160  D283                    1166      ADD.L   D3,D1
00002162  6000 000E               1167      BRA     DISPLAY_DISPLACEMENT_AS_ADDRESS
00002166                          1168  
00002166                          1169  IF_NEGATIVE_WORD
00002166  223C FFFF0000           1170      MOVE.L  #$FFFF0000,D1
0000216C  D283                    1171      ADD.L   D3,D1
0000216E  6000 0002               1172      BRA     DISPLAY_DISPLACEMENT_AS_ADDRESS
00002172                          1173  
00002172                          1174  DISPLAY_DISPLACEMENT_AS_ADDRESS
00002172  103C 0003               1175      MOVE.B  #3,D0
00002176  4E4F                    1176      TRAP    #15
00002178  6000 EF60               1177      BRA     ITERATE
0000217C                          1178  
0000217C                          1179  
0000217C                          1180  
0000217C                          1181  
0000217C                          1182  -------------------- end include --------------------
0000217C                          1183          INCLUDE MOVEQ.X68
00003100                          1184      ORG     $3100
00003100                          1185  
00003100                          1186  IF_MOVEQ
00003100  360C                    1187      MOVE.W  A4,D3
00003102                          1188      
00003102  C67C F100               1189      AND.W   #$F100,D3
00003106  B67C 7000               1190      CMP.W   #$7000,D3
0000310A  6700 0006               1191      BEQ     DISPLAY_MOVEQ
0000310E                          1192      
0000310E  6000 DFBA               1193      BRA     IF_INVALID_OP
00003112                          1194      
00003112                          1195  DISPLAY_MOVEQ
00003112  43F9 00001143           1196      LEA     MOVEQ_OUTPUT,A1
00003118  103C 000E               1197      MOVE.B  #14,D0
0000311C  4E4F                    1198      TRAP    #15
0000311E                          1199      
0000311E                          1200      ;Display the value
0000311E  143C 0010               1201      MOVE.B  #16,D2
00003122                          1202      
00003122  123C 0023               1203      MOVE.B  #NUM,D1
00003126  103C 0006               1204      MOVE.B  #6,D0
0000312A  4E4F                    1205      TRAP    #15
0000312C                          1206      
0000312C  123C 0024               1207      MOVE.B  #HEX,D1
00003130  103C 0006               1208      MOVE.B  #6,D0
00003134  4E4F                    1209      TRAP    #15
00003136                          1210      
00003136  360C                    1211      MOVE.W  A4,D3
00003138  C67C 00FF               1212      AND.W   #$00FF,D3
0000313C                          1213      
0000313C  103C 000F               1214      MOVE.B  #15,D0
00003140  2203                    1215      MOVE.L  D3,D1
00003142  C6BC 000000FF           1216      AND.L   #$000000FF,D3
00003148  4E4F                    1217      TRAP    #15
0000314A                          1218      
0000314A  123C 002C               1219      MOVE.B  #COMMA,D1
0000314E  103C 0006               1220      MOVE.B  #6,D0
00003152  4E4F                    1221      TRAP    #15
00003154                          1222      
00003154                          1223      ;Display the resgister
00003154  360C                    1224      MOVE.W  A4,D3
00003156  C67C 0E00               1225      AND.W   #$0E00,D3
0000315A  EF5B                    1226      ROL.W   #7,D3
0000315C                          1227      
0000315C  103C 000F               1228      MOVE.B  #15,D0
00003160  2203                    1229      MOVE.L  D3,D1
00003162  C6BC 00000007           1230      AND.L   #$00000007,D3
00003168  4E4F                    1231      TRAP    #15
0000316A                          1232      
0000316A  6000 DF6E               1233      BRA     ITERATE
0000316E                          1234  
0000316E                          1235  
0000316E                          1236      
0000316E                          1237  
0000316E                          1238  -------------------- end include --------------------
0000316E                          1239          INCLUDE MISC_CODE.X68
00002CE0                          1240      ORG    $2CE0
00002CE0                          1241  
00002CE0                          1242  IF_MISC
00002CE0  360C                    1243      MOVE.W  A4,D3
00002CE2                          1244      
00002CE2  C67C FF00               1245      AND.W   #$FF00,D3
00002CE6                          1246     
00002CE6  B67C 4600               1247      CMP.W   #$4600,D3
00002CEA  6700 0030               1248      BEQ     IF_NOT
00002CEE                          1249      
00002CEE  B67C 4E00               1250      CMP.W   #$4E00,D3
00002CF2  6700 00BC               1251      BEQ     IF_JSR
00002CF6                          1252      
00002CF6                          1253      ;Check to see if it might be MULS.L OR DIVU.L
00002CF6                          1254      
00002CF6  360C                    1255      MOVE.W  A4,D3
00002CF8  C67C FFC0               1256      AND.W   #$FFC0,D3
00002CFC                          1257      
00002CFC  B67C 4C00               1258      CMP.W   #$4C00,D3
00002D00  6700 011A               1259      BEQ     IF_MULS_L
00002D04                          1260      
00002D04  B67C 4C40               1261      CMP.W   #$4C40,D3
00002D08  6700 0116               1262      BEQ     IF_DIVU_L
00002D0C                          1263      
00002D0C                          1264      ;Check to see if it might be LEA
00002D0C  C67C 01C0               1265      AND.W   #$01C0,D3
00002D10                          1266      
00002D10  B67C 01C0               1267      CMP.W   #$01C0,D3
00002D14  6700 00BC               1268      BEQ     IF_LEA
00002D18                          1269      
00002D18                          1270      ;Check if it's MOVEM
00002D18  6000 1046               1271      BRA     IF_MOVEM
00002D1C                          1272  
00002D1C                          1273  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002D1C                          1274  ;NOT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002D1C                          1275  IF_NOT
00002D1C  43F9 00001136           1276      LEA     NOT_OUTPUT,A1
00002D22  103C 000E               1277      MOVE.B  #14,D0
00002D26  4E4F                    1278      TRAP    #15
00002D28                          1279  
00002D28  360C                    1280      MOVE.W  A4,D3
00002D2A  C67C 00C0               1281      AND.W   #$00C0,D3
00002D2E                          1282      
00002D2E  B67C 0000               1283      CMP.W   #$0000,D3
00002D32  6700 0016               1284      BEQ     DISPLAY_NOT_BYTE
00002D36                          1285      
00002D36  B67C 0040               1286      CMP.W   #$0040,D3
00002D3A  6700 0030               1287      BEQ     DISPLAY_NOT_WORD
00002D3E                          1288      
00002D3E  B67C 0080               1289      CMP.W   #$0080,D3
00002D42  6700 004A               1290      BEQ     DISPLAY_NOT_LONG
00002D46                          1291  
00002D46  6000 E382               1292      BRA     IF_INVALID_OP
00002D4A                          1293  
00002D4A                          1294  DISPLAY_NOT_BYTE
00002D4A  43F9 0000117C           1295      LEA     B_OUTPUT,A1
00002D50  103C 000E               1296      MOVE.B  #14,D0
00002D54  4E4F                    1297      TRAP    #15
00002D56                          1298      
00002D56  380C                    1299      MOVE.W  A4,D4 ;register
00002D58  3A0C                    1300      MOVE.W  A4,D5 ;mode
00002D5A                          1301      
00002D5A  C87C 0007               1302      AND.W   #$0007,D4
00002D5E                          1303      
00002D5E  CA7C 0038               1304      AND.W   #$0038,D5
00002D62  E74D                    1305      LSL.W   #3,D5
00002D64                          1306      
00002D64  6100 00BE               1307      BSR     DISPLAY_ea_NOT
00002D68                          1308  
00002D68  6000 E370               1309      BRA     ITERATE
00002D6C                          1310  
00002D6C                          1311  DISPLAY_NOT_WORD
00002D6C  43F9 00001180           1312      LEA     W_OUTPUT,A1
00002D72  103C 000E               1313      MOVE.B  #14,D0
00002D76  4E4F                    1314      TRAP    #15
00002D78                          1315      
00002D78  380C                    1316      MOVE.W  A4,D4 ;register
00002D7A  3A0C                    1317      MOVE.W  A4,D5 ;mode
00002D7C                          1318      
00002D7C  C87C 0007               1319      AND.W   #$0007,D4
00002D80                          1320      
00002D80  CA7C 0038               1321      AND.W   #$0038,D5
00002D84  E64D                    1322      LSR.W   #3,D5
00002D86                          1323      
00002D86  6100 009C               1324      BSR     DISPLAY_ea_NOT
00002D8A                          1325      
00002D8A  6000 E34E               1326      BRA     ITERATE
00002D8E                          1327  
00002D8E                          1328  DISPLAY_NOT_LONG
00002D8E  43F9 00001184           1329      LEA     L_OUTPUT,A1
00002D94  103C 000E               1330      MOVE.B  #14,D0
00002D98  4E4F                    1331      TRAP    #15
00002D9A                          1332      
00002D9A  380C                    1333      MOVE.W  A4,D4 ;register
00002D9C  3A0C                    1334      MOVE.W  A4,D5 ;mode
00002D9E                          1335      
00002D9E  C87C 0007               1336      AND.W   #$0007,D4
00002DA2                          1337      
00002DA2  CA7C 0038               1338      AND.W   #$0038,D5
00002DA6  E64D                    1339      LSR.W   #3,D5    
00002DA8                          1340      
00002DA8  6100 007A               1341      BSR     DISPLAY_ea_NOT
00002DAC                          1342      
00002DAC  6000 E32C               1343      BRA     ITERATE
00002DB0                          1344  
00002DB0                          1345  
00002DB0                          1346  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002DB0                          1347  ;JSR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002DB0                          1348  IF_JSR
00002DB0  43F9 0000113A           1349      LEA     JSR_OUTPUT,A1
00002DB6  103C 000E               1350      MOVE.B  #14,D0
00002DBA  4E4F                    1351      TRAP    #15
00002DBC                          1352  
00002DBC  380C                    1353      MOVE.W  A4,D4 ;register
00002DBE  3A0C                    1354      MOVE.W  A4,D5 ;mode
00002DC0                          1355      
00002DC0  C87C 0007               1356      AND.W   #$0007,D4
00002DC4                          1357      
00002DC4  CA7C 0038               1358      AND.W   #$0038,D5
00002DC8  E74D                    1359      LSL.W   #3,D5    
00002DCA                          1360      
00002DCA  6100 017C               1361      BSR     DISPLAY_ea_JSR_LEA
00002DCE                          1362      
00002DCE  6000 E30A               1363      BRA     ITERATE
00002DD2                          1364  
00002DD2                          1365  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002DD2                          1366  ;LEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002DD2                          1367  IF_LEA
00002DD2  43F9 0000113A           1368      LEA     JSR_OUTPUT,A1
00002DD8  103C 000E               1369      MOVE.B  #14,D0
00002DDC  4E4F                    1370      TRAP    #15
00002DDE                          1371      
00002DDE  380C                    1372      MOVE.W  A4,D4 ;ea register
00002DE0  3A0C                    1373      MOVE.W  A4,D5 ;ea mode
00002DE2                          1374  
00002DE2  C87C 0007               1375      AND.W   #$0007,D4
00002DE6  CA7C 0038               1376      AND.W   #$0038,D5
00002DEA                          1377      
00002DEA  E64D                    1378      LSR.W   #3,D5 
00002DEC                          1379      
00002DEC  6100 015A               1380      BSR     DISPLAY_ea_JSR_LEA
00002DF0                          1381      
00002DF0  123C 002C               1382      MOVE.B  #COMMA,D1
00002DF4  103C 0006               1383      MOVE.B  #6,D0
00002DF8  4E4F                    1384      TRAP    #15
00002DFA                          1385      
00002DFA  123C 0041               1386      MOVE.B  #A,D1
00002DFE  103C 0006               1387      MOVE.B  #6,D0
00002E02  4E4F                    1388      TRAP    #15
00002E04                          1389      
00002E04  320C                    1390      MOVE.W  A4,D1
00002E06                          1391      
00002E06  C27C 0E00               1392      AND.W   #$0E00,D1
00002E0A                          1393      
00002E0A  EE49                    1394      LSR     #7,D1
00002E0C  E449                    1395      LSR     #2,D1   
00002E0E                          1396          
00002E0E  143C 0010               1397      MOVE.B  #16,D2
00002E12  103C 000F               1398      MOVE.B  #15,D0
00002E16  4E4F                    1399      TRAP    #15
00002E18                          1400      
00002E18  6000 E2C0               1401      BRA     ITERATE
00002E1C                          1402      
00002E1C                          1403  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002E1C                          1404  ;MULS.L;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002E1C                          1405  IF_MULS_L
00002E1C  6000 E2AC               1406      BRA     IF_INVALID_OP
00002E20                          1407  
00002E20                          1408  
00002E20                          1409  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002E20                          1410  ;DIVU.L;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002E20                          1411  IF_DIVU_L
00002E20  6000 E2A8               1412      BRA     IF_INVALID_OP
00002E24                          1413  
00002E24                          1414      
00002E24                          1415  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002E24                          1416  DISPLAY_ea_NOT
00002E24  B87C 0000               1417      CMP.W   #%000,D4
00002E28  6700 0026               1418      BEQ     DISPLAY_Dn_NOT
00002E2C                          1419  
00002E2C  B87C 0002               1420      CMP.W   #%010,D4
00002E30  6700 0036               1421      BEQ     DISPLAY_An_ADDRESS_NOT
00002E34                          1422      
00002E34  B87C 0003               1423      CMP.W   #%011,D4
00002E38  6700 005A               1424      BEQ     DISPLAY_An_ADDRESS_INCREMENT_NOT
00002E3C                          1425      
00002E3C  B87C 0004               1426      CMP.W   #%100,D4
00002E40  6700 0088               1427      BEQ     DISPLAY_An_ADDRESS_DECREMENT_NOT
00002E44                          1428      
00002E44  B87C 0007               1429      CMP.W   #%111,D4
00002E48  6700 00B6               1430      BEQ     DISPLAY_ADDRESS_OR_DATA_NOT
00002E4C                          1431      
00002E4C  6000 E27C               1432      BRA     IF_INVALID_OP
00002E50                          1433      
00002E50                          1434  DISPLAY_Dn_NOT
00002E50  123C 0044               1435      MOVE.B  #D,D1
00002E54  103C 0006               1436      MOVE.B  #6,D0
00002E58  4E4F                    1437      TRAP    #15
00002E5A                          1438      
00002E5A  143C 0010               1439      MOVE.B  #16,D2
00002E5E  103C 000F               1440      MOVE.B  #15,D0
00002E62  2205                    1441      MOVE.L  D5,D1
00002E64  4E4F                    1442      TRAP    #15
00002E66                          1443      
00002E66  4E75                    1444      RTS
00002E68                          1445  
00002E68                          1446  DISPLAY_An_ADDRESS_NOT
00002E68  123C 0028               1447      MOVE.B  #LEFT_PAR,D1
00002E6C  103C 0006               1448      MOVE.B  #6,D0
00002E70  4E4F                    1449      TRAP    #15
00002E72                          1450  
00002E72  123C 0041               1451      MOVE.B  #A,D1
00002E76  103C 0006               1452      MOVE.B  #6,D0
00002E7A  4E4F                    1453      TRAP    #15
00002E7C                          1454      
00002E7C  143C 0010               1455      MOVE.B  #16,D2
00002E80  103C 000F               1456      MOVE.B  #15,D0
00002E84  2205                    1457      MOVE.L  D5,D1
00002E86  4E4F                    1458      TRAP    #15
00002E88                          1459      
00002E88  123C 0029               1460      MOVE.B  #RIGHT_PAR,D1
00002E8C  103C 0006               1461      MOVE.B  #6,D0
00002E90  4E4F                    1462      TRAP    #15
00002E92                          1463  
00002E92  4E75                    1464      RTS
00002E94                          1465  
00002E94                          1466  DISPLAY_An_ADDRESS_INCREMENT_NOT
00002E94  123C 0028               1467      MOVE.B  #LEFT_PAR,D1
00002E98  103C 0006               1468      MOVE.B  #6,D0
00002E9C  4E4F                    1469      TRAP    #15
00002E9E                          1470  
00002E9E  123C 0041               1471      MOVE.B  #A,D1
00002EA2  103C 0006               1472      MOVE.B  #6,D0
00002EA6  4E4F                    1473      TRAP    #15
00002EA8                          1474      
00002EA8  143C 0010               1475      MOVE.B  #16,D2
00002EAC  103C 000F               1476      MOVE.B  #15,D0
00002EB0  2205                    1477      MOVE.L  D5,D1
00002EB2  4E4F                    1478      TRAP    #15
00002EB4                          1479      
00002EB4  123C 0029               1480      MOVE.B  #RIGHT_PAR,D1
00002EB8  103C 0006               1481      MOVE.B  #6,D0
00002EBC  4E4F                    1482      TRAP    #15
00002EBE                          1483      
00002EBE  123C 002B               1484      MOVE.B  #PLUS,D1
00002EC2  103C 0006               1485      MOVE.B  #6,D0
00002EC6  4E4F                    1486      TRAP    #15
00002EC8                          1487      
00002EC8  4E75                    1488      RTS
00002ECA                          1489  
00002ECA                          1490  DISPLAY_An_ADDRESS_DECREMENT_NOT
00002ECA  123C 002D               1491      MOVE.B  #MINUS,D1
00002ECE  103C 0006               1492      MOVE.B  #6,D0
00002ED2  4E4F                    1493      TRAP    #15
00002ED4                          1494  
00002ED4  123C 0028               1495      MOVE.B  #LEFT_PAR,D1
00002ED8  103C 0006               1496      MOVE.B  #6,D0
00002EDC  4E4F                    1497      TRAP    #15
00002EDE                          1498  
00002EDE  123C 0041               1499      MOVE.B  #A,D1
00002EE2  103C 0006               1500      MOVE.B  #6,D0
00002EE6  4E4F                    1501      TRAP    #15
00002EE8                          1502      
00002EE8  143C 0010               1503      MOVE.B  #16,D2
00002EEC  103C 000F               1504      MOVE.B  #15,D0
00002EF0  2205                    1505      MOVE.L  D5,D1
00002EF2  4E4F                    1506      TRAP    #15
00002EF4                          1507      
00002EF4  123C 0029               1508      MOVE.B  #RIGHT_PAR,D1
00002EF8  103C 0006               1509      MOVE.B  #6,D0
00002EFC  4E4F                    1510      TRAP    #15
00002EFE                          1511  
00002EFE  4E75                    1512      RTS
00002F00                          1513  
00002F00                          1514  DISPLAY_ADDRESS_OR_DATA_NOT
00002F00  B87C 0000               1515      CMP.W   #%000,D4
00002F04  6700 E704               1516      BEQ     DISPLAY_ADDRESS_WORD_SRC
00002F08                          1517      
00002F08  B87C 0001               1518      CMP.W   #%001,D4
00002F0C  6700 E71A               1519      BEQ     DISPLAY_ADDRESS_LONG_SRC
00002F10                          1520  
00002F10  6000 E1B8               1521      BRA     IF_INVALID_OP
00002F14                          1522  
00002F14                          1523  DISPLAY_ADDRESS_WORD_NOT
00002F14  544A                    1524      ADDQ    #2,A2
00002F16                          1525      
00002F16  123C 0024               1526      MOVE.B  #HEX,D1
00002F1A  103C 0006               1527      MOVE.B  #6,D0
00002F1E  4E4F                    1528      TRAP    #15
00002F20                          1529      
00002F20  3212                    1530      MOVE.W  (A2),D1
00002F22  C2BC 0000FFFF           1531      AND.L   #$0000FFFF,D1
00002F28  103C 000F               1532      MOVE.B  #15,D0
00002F2C  4E4F                    1533      TRAP    #15
00002F2E                          1534      
00002F2E  4E75                    1535      RTS
00002F30                          1536  
00002F30                          1537  DISPLAY_ADDRESS_LONG_NOT
00002F30  544A                    1538      ADDQ    #2,A2
00002F32                          1539      
00002F32  123C 0024               1540      MOVE.B  #HEX,D1
00002F36  103C 0006               1541      MOVE.B  #6,D0
00002F3A  4E4F                    1542      TRAP    #15
00002F3C                          1543      
00002F3C  2212                    1544      MOVE.L  (A2),D1
00002F3E  103C 000F               1545      MOVE.B  #15,D0
00002F42  4E4F                    1546      TRAP    #15
00002F44                          1547      
00002F44  544A                    1548      ADDQ    #2,A2
00002F46                          1549  
00002F46  4E75                    1550      RTS
00002F48                          1551      
00002F48                          1552  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002F48                          1553  DISPLAY_ea_JSR_LEA
00002F48  B87C 0002               1554      CMP.W   #%010,D4
00002F4C  6700 FF1A               1555      BEQ     DISPLAY_An_ADDRESS_NOT
00002F50                          1556      
00002F50  B87C 0007               1557      CMP.W   #%111,D4
00002F54  67AA                    1558      BEQ     DISPLAY_ADDRESS_OR_DATA_NOT
00002F56                          1559      
00002F56  6000 E172               1560      BRA     IF_INVALID_OP 
00002F5A                          1561      
00002F5A                          1562  
00002F5A                          1563  
00002F5A                          1564  -------------------- end include --------------------
00002F5A                          1565          INCLUDE DIVU_OR.X68
000024A0                          1566      ORG    $24A0
000024A0                          1567  IF_DIVU_OR
000024A0  360C                    1568      MOVE.W  A4,D3
000024A2                          1569      
000024A2                          1570      ;Get the register
000024A2  C67C 0FFF               1571      AND.W   #$0FFF,D3
000024A6  E743                    1572      ASL.W   #3,D3
000024A8  3803                    1573      MOVE.W  D3,D4
000024AA  C8BC 0000F000           1574      AND.L   #$0000F000,D4
000024B0  E95C                    1575      ROL.W   #4,D4
000024B2  2844                    1576      MOVE.L  D4,A4 ;register
000024B4                          1577  
000024B4                          1578      ;Get the opmode
000024B4  C67C 0FFF               1579      AND.W   #$0FFF,D3
000024B8  E743                    1580      ASL.W   #3,D3
000024BA  3803                    1581      MOVE.W  D3,D4
000024BC  C8BC 0000F000           1582      AND.L   #$0000F000,D4
000024C2  E95C                    1583      ROL.W   #4,D4
000024C4  2A44                    1584      MOVE.L  D4,A5 ;opmode
000024C6                          1585  
000024C6                          1586      ;Get the effective mode 
000024C6  C67C 0FFF               1587      AND.W   #$0FFF,D3
000024CA  E743                    1588      ASL.W   #3,D3
000024CC  3803                    1589      MOVE.W  D3,D4
000024CE  C8BC 0000F000           1590      AND.L   #$0000F000,D4
000024D4  E95C                    1591      ROL.W   #4,D4
000024D6  2C44                    1592      MOVE.L  D4,A6 ;effective mode
000024D8                          1593      
000024D8                          1594      ;Get the effective register
000024D8  C67C 0FFF               1595      AND.W   #$0FFF,D3
000024DC  E743                    1596      ASL.W   #3,D3
000024DE  3803                    1597      MOVE.W  D3,D4
000024E0  C8BC 0000F000           1598      AND.L   #$0000F000,D4
000024E6  E95C                    1599      ROL.W   #4,D4 ;effective register
000024E8                          1600      
000024E8  143C 0010               1601      MOVE.B  #16,D2
000024EC  103C 000F               1602      MOVE.B  #15,D0
000024F0                          1603      
000024F0  6000 0002               1604      BRA     DETERMINE_DIVU_OR
000024F4                          1605  
000024F4                          1606  DETERMINE_DIVU_OR
000024F4  BAFC 0003               1607      CMP.W   #%011,A5
000024F8  6700 0146               1608      BEQ     DISPLAY_DIVU
000024FC                          1609      
000024FC  BAFC 0007               1610      CMP.W   #%111,A5
00002500  6700 EBC8               1611      BEQ     IF_INVALID_OP
00002504                          1612      
00002504  6000 0002               1613      BRA     DISPLAY_OR
00002508                          1614  
00002508                          1615  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002508                          1616  ;OR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002508                          1617  DISPLAY_OR
00002508  43F9 0000112E           1618      LEA     OR_OUTPUT,A1
0000250E  103C 000E               1619      MOVE.B  #14,D0
00002512  4E4F                    1620      TRAP    #15
00002514                          1621  
00002514  BAFC 0000               1622      CMP.W   #%000,A5
00002518  6700 002E               1623      BEQ     DISPLAY_BYTE_SRC_OR
0000251C                          1624      
0000251C  BAFC 0001               1625      CMP.W   #%001,A5
00002520  6700 0048               1626      BEQ     DISPLAY_WORD_SRC_OR
00002524                          1627      
00002524  BAFC 0002               1628      CMP.W   #%010,A5
00002528  6700 0062               1629      BEQ     DISPLAY_LONG_SRC_OR
0000252C                          1630      
0000252C  BAFC 0004               1631      CMP.W   #%100,A5
00002530  6700 007C               1632      BEQ     DISPLAY_BYTE_DEST_OR
00002534                          1633      
00002534  BAFC 0005               1634      CMP.W   #%101,A5
00002538  6700 0096               1635      BEQ     DISPLAY_WORD_DEST_OR
0000253C                          1636      
0000253C  BAFC 0006               1637      CMP.W   #%110,A5
00002540  6700 00B0               1638      BEQ     DISPLAY_LONG_DEST_OR
00002544                          1639      
00002544  6000 EB84               1640      BRA     IF_INVALID_OP 
00002548                          1641  
00002548                          1642  DISPLAY_BYTE_SRC_OR
00002548  43F9 0000117C           1643      LEA     B_OUTPUT,A1
0000254E  103C 000E               1644      MOVE.B  #14,D0
00002552  4E4F                    1645      TRAP    #15
00002554                          1646  
00002554  6100 00BE               1647      BSR     GET_EFFECTIVE_ADDRESS_OR_SRC  
00002558                          1648      
00002558  123C 002C               1649      MOVE.B  #COMMA,D1
0000255C  103C 0006               1650      MOVE.B  #6,D0
00002560  4E4F                    1651      TRAP    #15
00002562                          1652      
00002562  6100 F686               1653      BSR     DISPLAY_Dn_ADD
00002566                          1654      
00002566  6000 EB72               1655      BRA     ITERATE
0000256A                          1656  
0000256A                          1657  DISPLAY_WORD_SRC_OR
0000256A  43F9 00001180           1658      LEA     W_OUTPUT,A1
00002570  103C 000E               1659      MOVE.B  #14,D0
00002574  4E4F                    1660      TRAP    #15
00002576                          1661  
00002576  6100 009C               1662      BSR     GET_EFFECTIVE_ADDRESS_OR_SRC  
0000257A                          1663  
0000257A  123C 002C               1664      MOVE.B  #COMMA,D1
0000257E  103C 0006               1665      MOVE.B  #6,D0
00002582  4E4F                    1666      TRAP    #15    
00002584                          1667  
00002584  6100 F664               1668      BSR     DISPLAY_Dn_ADD
00002588                          1669      
00002588  6000 EB50               1670      BRA     ITERATE
0000258C                          1671  
0000258C                          1672  DISPLAY_LONG_SRC_OR
0000258C  43F9 00001184           1673      LEA     L_OUTPUT,A1
00002592  103C 000E               1674      MOVE.B  #14,D0
00002596  4E4F                    1675      TRAP    #15
00002598                          1676  
00002598  6100 007A               1677      BSR     GET_EFFECTIVE_ADDRESS_OR_SRC  
0000259C                          1678  
0000259C  123C 002C               1679      MOVE.B  #COMMA,D1
000025A0  103C 0006               1680      MOVE.B  #6,D0
000025A4  4E4F                    1681      TRAP    #15    
000025A6                          1682  
000025A6  6100 F642               1683      BSR     DISPLAY_Dn_ADD
000025AA                          1684      
000025AA  6000 EB2E               1685      BRA     ITERATE
000025AE                          1686  
000025AE                          1687  DISPLAY_BYTE_DEST_OR
000025AE  43F9 0000117C           1688      LEA     B_OUTPUT,A1
000025B4  103C 000E               1689      MOVE.B  #14,D0
000025B8  4E4F                    1690      TRAP    #15
000025BA                          1691  
000025BA  6100 F62E               1692      BSR     DISPLAY_Dn_ADD
000025BE                          1693      
000025BE  123C 002C               1694      MOVE.B  #COMMA,D1
000025C2  103C 0006               1695      MOVE.B  #6,D0
000025C6  4E4F                    1696      TRAP    #15    
000025C8                          1697  
000025C8  6100 F638               1698      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
000025CC                          1699      
000025CC  6000 EB0C               1700      BRA     ITERATE
000025D0                          1701  
000025D0                          1702  DISPLAY_WORD_DEST_OR
000025D0  43F9 00001180           1703      LEA     W_OUTPUT,A1
000025D6  103C 000E               1704      MOVE.B  #14,D0
000025DA  4E4F                    1705      TRAP    #15
000025DC                          1706  
000025DC  6100 F60C               1707      BSR     DISPLAY_Dn_ADD
000025E0                          1708      
000025E0  123C 002C               1709      MOVE.B  #COMMA,D1
000025E4  103C 0006               1710      MOVE.B  #6,D0
000025E8  4E4F                    1711      TRAP    #15    
000025EA                          1712  
000025EA  6100 F616               1713      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
000025EE                          1714      
000025EE  6000 EAEA               1715      BRA     ITERATE
000025F2                          1716  
000025F2                          1717  DISPLAY_LONG_DEST_OR
000025F2  43F9 00001184           1718      LEA     L_OUTPUT,A1
000025F8  103C 000E               1719      MOVE.B  #14,D0
000025FC  4E4F                    1720      TRAP    #15
000025FE                          1721  
000025FE  6100 F5EA               1722      BSR     DISPLAY_Dn_ADD
00002602                          1723      
00002602  123C 002C               1724      MOVE.B  #COMMA,D1
00002606  103C 0006               1725      MOVE.B  #6,D0
0000260A  4E4F                    1726      TRAP    #15    
0000260C                          1727  
0000260C  6100 F5F4               1728      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00002610                          1729      
00002610  6000 EAC8               1730      BRA     ITERATE
00002614                          1731  
00002614                          1732  GET_EFFECTIVE_ADDRESS_OR_SRC   
00002614  BCFC 0000               1733      CMP.W   #%000,A6
00002618  6700 F302               1734      BEQ     DISPLAY_Dn_ea
0000261C                          1735  
0000261C  BCFC 0002               1736      CMP.W   #%010,A6
00002620  6700 F32A               1737      BEQ     DISPLAY_An_ADDRESS_ea
00002624                          1738      
00002624  BCFC 0003               1739      CMP.W   #%011,A6
00002628  6700 F34E               1740      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
0000262C                          1741      
0000262C  BCFC 0004               1742      CMP.W   #%100,A6
00002630  6700 F37C               1743      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
00002634                          1744      
00002634  BCFC 0007               1745      CMP.W   #%111,A6
00002638  6700 107E               1746      BEQ     DISPLAY_ADDRESS_OR_DATA_AND_SRC
0000263C                          1747      
0000263C  6000 EA8C               1748      BRA     IF_INVALID_OP
00002640                          1749  
00002640                          1750  
00002640                          1751  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002640                          1752  ;DIVU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00002640                          1753  
00002640                          1754  ;NOT IMPLEMENTED YET!
00002640                          1755  
00002640                          1756  DISPLAY_DIVU
00002640  6000 EA88               1757      BRA     IF_INVALID_OP
00002644                          1758  
00002644                          1759  
00002644                          1760  
00002644                          1761  
00002644                          1762  -------------------- end include --------------------
00002644                          1763          INCLUDE MOVE_MOVEA.X68
00001420                          1764      ORG    $1420
00001420                          1765      
00001420                          1766  PARSE_MOVE
00001420  360C                    1767      MOVE.W  A4,D3
00001422                          1768      
00001422                          1769      ;Get the destination register
00001422  C67C 0FFF               1770      AND.W   #$0FFF,D3
00001426  E743                    1771      ASL.W   #3,D3
00001428  3803                    1772      MOVE.W  D3,D4
0000142A  C8BC 0000F000           1773      AND.L   #$0000F000,D4
00001430  E95C                    1774      ROL.W   #4,D4
00001432  2844                    1775      MOVE.L  D4,A4 ;Destination register
00001434                          1776  
00001434                          1777      ;Get the destination mode
00001434  C67C 0FFF               1778      AND.W   #$0FFF,D3
00001438  E743                    1779      ASL.W   #3,D3
0000143A  3803                    1780      MOVE.W  D3,D4
0000143C  C8BC 0000F000           1781      AND.L   #$0000F000,D4
00001442  E95C                    1782      ROL.W   #4,D4
00001444  2A44                    1783      MOVE.L  D4,A5 ;Destination mode
00001446                          1784  
00001446                          1785      ;Get the source mode 
00001446  C67C 0FFF               1786      AND.W   #$0FFF,D3
0000144A  E743                    1787      ASL.W   #3,D3
0000144C  3803                    1788      MOVE.W  D3,D4
0000144E  C8BC 0000F000           1789      AND.L   #$0000F000,D4
00001454  E95C                    1790      ROL.W   #4,D4
00001456  2C44                    1791      MOVE.L  D4,A6 ;Source mode
00001458                          1792      
00001458                          1793      ;Get the source register
00001458  C67C 0FFF               1794      AND.W   #$0FFF,D3
0000145C  E743                    1795      ASL.W   #3,D3
0000145E  3803                    1796      MOVE.W  D3,D4
00001460  C8BC 0000F000           1797      AND.L   #$0000F000,D4
00001466  E95C                    1798      ROL.W   #4,D4 ;Source register
00001468                          1799      
00001468  143C 0010               1800      MOVE.B  #16,D2
0000146C  103C 000F               1801      MOVE.B  #15,D0
00001470                          1802      
00001470  BAFC 0001               1803      CMP.W   #%001,A5
00001474  6700 0006               1804      BEQ     DISPLAY_MOVEA
00001478  6000 0012               1805      BRA     DISPLAY_MOVE
0000147C                          1806      
0000147C                          1807  DISPLAY_MOVEA
0000147C  43F9 00001108           1808      LEA     MOVEA_OUTPUT,A1
00001482  103C 000E               1809      MOVE.B  #14,D0
00001486  4E4F                    1810      TRAP    #15
00001488  6000 0012               1811      BRA     DISPLAY_TYPE
0000148C                          1812  
0000148C                          1813  DISPLAY_MOVE
0000148C  43F9 0000110E           1814      LEA     MOVE_OUTPUT,A1
00001492  103C 000E               1815      MOVE.B  #14,D0
00001496  4E4F                    1816      TRAP    #15
00001498  6000 0002               1817      BRA     DISPLAY_TYPE
0000149C                          1818      
0000149C                          1819  DISPLAY_TYPE
0000149C  BA7C 1000               1820      CMP.W   #MOVE_B_CODE,D5
000014A0  6700 0016               1821      BEQ     DISPLAY_BYTE
000014A4                          1822      
000014A4  BA7C 3000               1823      CMP.W   #MOVE_W_CODE,D5
000014A8  6700 001E               1824      BEQ     DISPLAY_WORD
000014AC                          1825      
000014AC  BA7C 2000               1826      CMP.W   #MOVE_L_CODE,D5
000014B0  6700 0026               1827      BEQ     DISPLAY_LONG
000014B4                          1828      
000014B4  6000 FC14               1829      BRA     IF_INVALID_OP     
000014B8                          1830      
000014B8                          1831  DISPLAY_BYTE
000014B8  43F9 0000117C           1832      LEA     B_OUTPUT,A1
000014BE  103C 000E               1833      MOVE.B  #14,D0
000014C2  4E4F                    1834      TRAP    #15
000014C4  6000 0022               1835      BRA     DISPLAY_SRC_MODE
000014C8                          1836  
000014C8                          1837  DISPLAY_WORD
000014C8  43F9 00001180           1838      LEA     W_OUTPUT,A1
000014CE  103C 000E               1839      MOVE.B  #14,D0
000014D2  4E4F                    1840      TRAP    #15
000014D4  6000 0012               1841      BRA     DISPLAY_SRC_MODE
000014D8                          1842  
000014D8                          1843  DISPLAY_LONG
000014D8  43F9 00001184           1844      LEA     L_OUTPUT,A1
000014DE  103C 000E               1845      MOVE.B  #14,D0
000014E2  4E4F                    1846      TRAP    #15
000014E4  6000 0002               1847      BRA     DISPLAY_SRC_MODE
000014E8                          1848  
000014E8                          1849  DISPLAY_SRC_MODE
000014E8  BCFC 0000               1850      CMP.W   #%000,A6
000014EC  6700 002E               1851      BEQ     DISPLAY_Dn_SRC
000014F0                          1852      
000014F0  BCFC 0001               1853      CMP.W   #%001,A6
000014F4  6700 0040               1854      BEQ     DISPLAY_An_SRC
000014F8                          1855      
000014F8  BCFC 0002               1856      CMP.W   #%010,A6
000014FC  6700 0052               1857      BEQ     DISPLAY_AT_An_SRC
00001500                          1858      
00001500  BCFC 0003               1859      CMP.W   #%011,A6
00001504  6700 0078               1860      BEQ     DISPLAY_AT_An_INCREMENT_SRC
00001508                          1861      
00001508  BCFC 0004               1862      CMP.W   #%100,A6
0000150C  6700 00A8               1863      BEQ     DISPLAY_AT_An_DECREMENT_SRC
00001510                          1864      
00001510  BCFC 0007               1865      CMP.W   #%111,A6
00001514  6700 00D8               1866      BEQ     DISPLAY_ADDRESS_OR_DATA_SRC
00001518                          1867      
00001518  6000 FBB0               1868      BRA     IF_INVALID_OP
0000151C                          1869      
0000151C                          1870  DISPLAY_Dn_SRC
0000151C  123C 0044               1871      MOVE.B  #D,D1
00001520  103C 0006               1872      MOVE.B  #6,D0
00001524  4E4F                    1873      TRAP    #15
00001526                          1874      
00001526  143C 0010               1875      MOVE.B  #16,D2
0000152A  103C 000F               1876      MOVE.B  #15,D0
0000152E  2204                    1877      MOVE.L  D4,D1
00001530  4E4F                    1878      TRAP    #15
00001532                          1879      
00001532  6000 01A0               1880      BRA     DISPLAY_DEST
00001536                          1881  
00001536                          1882  DISPLAY_An_SRC
00001536  123C 0041               1883      MOVE.B  #A,D1
0000153A  103C 0006               1884      MOVE.B  #6,D0
0000153E  4E4F                    1885      TRAP    #15
00001540                          1886      
00001540  143C 0010               1887      MOVE.B  #16,D2
00001544  103C 000F               1888      MOVE.B  #15,D0
00001548  2204                    1889      MOVE.L  D4,D1
0000154A  4E4F                    1890      TRAP    #15
0000154C                          1891  
0000154C  6000 0186               1892      BRA     DISPLAY_DEST
00001550                          1893  
00001550                          1894  DISPLAY_AT_An_SRC
00001550  123C 0028               1895      MOVE.B  #LEFT_PAR,D1
00001554  103C 0006               1896      MOVE.B  #6,D0
00001558  4E4F                    1897      TRAP    #15
0000155A                          1898  
0000155A  123C 0041               1899      MOVE.B  #A,D1
0000155E  103C 0006               1900      MOVE.B  #6,D0
00001562  4E4F                    1901      TRAP    #15
00001564                          1902      
00001564  143C 0010               1903      MOVE.B  #16,D2
00001568  103C 000F               1904      MOVE.B  #15,D0
0000156C  2204                    1905      MOVE.L  D4,D1
0000156E  4E4F                    1906      TRAP    #15
00001570                          1907      
00001570  123C 0029               1908      MOVE.B  #RIGHT_PAR,D1
00001574  103C 0006               1909      MOVE.B  #6,D0
00001578  4E4F                    1910      TRAP    #15
0000157A                          1911  
0000157A  6000 0158               1912      BRA     DISPLAY_DEST
0000157E                          1913  
0000157E                          1914  DISPLAY_AT_An_INCREMENT_SRC
0000157E  123C 0028               1915      MOVE.B  #LEFT_PAR,D1
00001582  103C 0006               1916      MOVE.B  #6,D0
00001586  4E4F                    1917      TRAP    #15
00001588                          1918  
00001588  123C 0041               1919      MOVE.B  #A,D1
0000158C  103C 0006               1920      MOVE.B  #6,D0
00001590  4E4F                    1921      TRAP    #15
00001592                          1922      
00001592  143C 0010               1923      MOVE.B  #16,D2
00001596  103C 000F               1924      MOVE.B  #15,D0
0000159A  2204                    1925      MOVE.L  D4,D1
0000159C  4E4F                    1926      TRAP    #15
0000159E                          1927      
0000159E  123C 0029               1928      MOVE.B  #RIGHT_PAR,D1
000015A2  103C 0006               1929      MOVE.B  #6,D0
000015A6  4E4F                    1930      TRAP    #15
000015A8                          1931      
000015A8  123C 002B               1932      MOVE.B  #PLUS,D1
000015AC  103C 0006               1933      MOVE.B  #6,D0
000015B0  4E4F                    1934      TRAP    #15
000015B2                          1935      
000015B2  6000 0120               1936      BRA     DISPLAY_DEST
000015B6                          1937  
000015B6                          1938  DISPLAY_AT_An_DECREMENT_SRC
000015B6  123C 002D               1939      MOVE.B  #MINUS,D1
000015BA  103C 0006               1940      MOVE.B  #6,D0
000015BE  4E4F                    1941      TRAP    #15
000015C0                          1942  
000015C0  123C 0028               1943      MOVE.B  #LEFT_PAR,D1
000015C4  103C 0006               1944      MOVE.B  #6,D0
000015C8  4E4F                    1945      TRAP    #15
000015CA                          1946  
000015CA  123C 0041               1947      MOVE.B  #A,D1
000015CE  103C 0006               1948      MOVE.B  #6,D0
000015D2  4E4F                    1949      TRAP    #15
000015D4                          1950      
000015D4  143C 0010               1951      MOVE.B  #16,D2
000015D8  103C 000F               1952      MOVE.B  #15,D0
000015DC  2204                    1953      MOVE.L  D4,D1
000015DE  4E4F                    1954      TRAP    #15
000015E0                          1955      
000015E0  123C 0029               1956      MOVE.B  #RIGHT_PAR,D1
000015E4  103C 0006               1957      MOVE.B  #6,D0
000015E8  4E4F                    1958      TRAP    #15
000015EA                          1959  
000015EA  6000 00E8               1960      BRA     DISPLAY_DEST
000015EE                          1961  
000015EE                          1962  DISPLAY_ADDRESS_OR_DATA_SRC
000015EE  B87C 0000               1963      CMP.W   #%000,D4
000015F2  6700 0016               1964      BEQ     DISPLAY_ADDRESS_WORD_SRC
000015F6                          1965      
000015F6  B87C 0001               1966      CMP.W   #%001,D4
000015FA  6700 002C               1967      BEQ     DISPLAY_ADDRESS_LONG_SRC
000015FE                          1968  
000015FE  B87C 0004               1969      CMP.W   #%100,D4
00001602  6700 003E               1970      BEQ     DISPLAY_DATA_SRC
00001606                          1971  
00001606  6000 FAC2               1972      BRA     IF_INVALID_OP
0000160A                          1973  
0000160A                          1974  DISPLAY_ADDRESS_WORD_SRC
0000160A  544A                    1975      ADDQ    #2,A2
0000160C                          1976      
0000160C  123C 0024               1977      MOVE.B  #HEX,D1
00001610  103C 0006               1978      MOVE.B  #6,D0
00001614  4E4F                    1979      TRAP    #15
00001616                          1980      
00001616  3212                    1981      MOVE.W  (A2),D1
00001618  C2BC 0000FFFF           1982      AND.L   #$0000FFFF,D1
0000161E  103C 000F               1983      MOVE.B  #15,D0
00001622  4E4F                    1984      TRAP    #15
00001624                          1985      
00001624  6000 00AE               1986      BRA     DISPLAY_DEST
00001628                          1987  
00001628                          1988  DISPLAY_ADDRESS_LONG_SRC
00001628  544A                    1989      ADDQ    #2,A2
0000162A                          1990      
0000162A  123C 0024               1991      MOVE.B  #HEX,D1
0000162E  103C 0006               1992      MOVE.B  #6,D0
00001632  4E4F                    1993      TRAP    #15
00001634                          1994      
00001634  2212                    1995      MOVE.L  (A2),D1
00001636  103C 000F               1996      MOVE.B  #15,D0
0000163A  4E4F                    1997      TRAP    #15
0000163C                          1998      
0000163C  544A                    1999      ADDQ    #2,A2
0000163E                          2000  
0000163E  6000 0094               2001      BRA     DISPLAY_DEST
00001642                          2002      
00001642                          2003  DISPLAY_DATA_SRC
00001642  BA7C 1000               2004      CMP.W   #MOVE_B_CODE,D5
00001646  6700 0016               2005      BEQ     DISPLAY_DATA_SRC_BYTE
0000164A                          2006      
0000164A  BA7C 3000               2007      CMP.W   #MOVE_W_CODE,D5
0000164E  6700 0038               2008      BEQ     DISPLAY_DATA_SRC_WORD
00001652                          2009      
00001652  BA7C 2000               2010      CMP.W   #MOVE_L_CODE,D5
00001656  6700 0058               2011      BEQ     DISPLAY_DATA_SRC_LONG
0000165A                          2012  
0000165A  6000 FA6E               2013      BRA     IF_INVALID_OP
0000165E                          2014      
0000165E                          2015  DISPLAY_DATA_SRC_BYTE
0000165E  564A                    2016      ADDQ    #3,A2
00001660                          2017      
00001660  123C 0023               2018      MOVE.B  #NUM,D1
00001664  103C 0006               2019      MOVE.B  #6,D0
00001668  4E4F                    2020      TRAP    #15    
0000166A                          2021      
0000166A  123C 0024               2022      MOVE.B  #HEX,D1
0000166E  103C 0006               2023      MOVE.B  #6,D0
00001672  4E4F                    2024      TRAP    #15
00001674                          2025      
00001674  1212                    2026      MOVE.B  (A2),D1
00001676  C2BC 000000FF           2027      AND.L   #$000000FF,D1
0000167C  103C 000F               2028      MOVE.B  #15,D0
00001680  4E4F                    2029      TRAP    #15
00001682                          2030      
00001682  534A                    2031      SUBQ    #1,A2
00001684                          2032  
00001684  6000 004E               2033      BRA     DISPLAY_DEST
00001688                          2034  
00001688                          2035  DISPLAY_DATA_SRC_WORD
00001688  544A                    2036      ADDQ    #2,A2
0000168A                          2037  
0000168A  123C 0023               2038      MOVE.B  #NUM,D1
0000168E  103C 0006               2039      MOVE.B  #6,D0
00001692  4E4F                    2040      TRAP    #15
00001694                          2041      
00001694  123C 0024               2042      MOVE.B  #HEX,D1
00001698  103C 0006               2043      MOVE.B  #6,D0
0000169C  4E4F                    2044      TRAP    #15
0000169E                          2045      
0000169E  3212                    2046      MOVE.W  (A2),D1
000016A0  C2BC 0000FFFF           2047      AND.L   #$0000FFFF,D1
000016A6  103C 000F               2048      MOVE.B  #15,D0
000016AA  4E4F                    2049      TRAP    #15
000016AC                          2050  
000016AC  6000 0026               2051      BRA     DISPLAY_DEST
000016B0                          2052      
000016B0                          2053  DISPLAY_DATA_SRC_LONG
000016B0  544A                    2054      ADDQ    #2,A2
000016B2                          2055      
000016B2  123C 0023               2056      MOVE.B  #NUM,D1
000016B6  103C 0006               2057      MOVE.B  #6,D0
000016BA  4E4F                    2058      TRAP    #15
000016BC                          2059      
000016BC  123C 0024               2060      MOVE.B  #HEX,D1
000016C0  103C 0006               2061      MOVE.B  #6,D0
000016C4  4E4F                    2062      TRAP    #15
000016C6                          2063      
000016C6  2212                    2064      MOVE.L  (A2),D1
000016C8  103C 000F               2065      MOVE.B  #15,D0
000016CC  4E4F                    2066      TRAP    #15
000016CE                          2067      
000016CE  544A                    2068      ADDQ    #2,A2
000016D0                          2069      
000016D0  6000 0002               2070      BRA     DISPLAY_DEST
000016D4                          2071      
000016D4                          2072  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000016D4                          2073  
000016D4                          2074  DISPLAY_DEST
000016D4  123C 002C               2075      MOVE.B  #COMMA,D1
000016D8  103C 0006               2076      MOVE.B  #6,D0
000016DC  4E4F                    2077      TRAP    #15
000016DE                          2078  
000016DE  BAFC 0000               2079      CMP.W   #%000,A5
000016E2  6700 002E               2080      BEQ     DISPLAY_Dn_DEST
000016E6                          2081      
000016E6  BAFC 0001               2082      CMP.W   #%001,A5
000016EA  6700 0040               2083      BEQ     DISPLAY_An_DEST
000016EE                          2084      
000016EE  BAFC 0002               2085      CMP.W   #%010,A5
000016F2  6700 0052               2086      BEQ     DISPLAY_AT_An_DEST
000016F6                          2087      
000016F6  BAFC 0003               2088      CMP.W   #%011,A5
000016FA  6700 0078               2089      BEQ     DISPLAY_AT_An_INCREMENT_DEST
000016FE                          2090      
000016FE  BAFC 0004               2091      CMP.W   #%100,A5
00001702  6700 00A8               2092      BEQ     DISPLAY_AT_An_DECREMENT_DEST
00001706                          2093      
00001706  BAFC 0007               2094      CMP.W   #%111,A5
0000170A  6700 00D8               2095      BEQ     DISPLAY_ADDRESS_OR_DATA_DEST
0000170E                          2096      
0000170E  6000 F9BA               2097      BRA     IF_INVALID_OP
00001712                          2098  
00001712                          2099  DISPLAY_Dn_DEST
00001712  123C 0044               2100      MOVE.B  #D,D1
00001716  103C 0006               2101      MOVE.B  #6,D0
0000171A  4E4F                    2102      TRAP    #15
0000171C                          2103      
0000171C  143C 0010               2104      MOVE.B  #16,D2
00001720  103C 000F               2105      MOVE.B  #15,D0
00001724  220C                    2106      MOVE.L  A4,D1
00001726  4E4F                    2107      TRAP    #15
00001728                          2108      
00001728  6000 F9B0               2109      BRA     ITERATE
0000172C                          2110  
0000172C                          2111  DISPLAY_An_DEST
0000172C  123C 0041               2112      MOVE.B  #A,D1
00001730  103C 0006               2113      MOVE.B  #6,D0
00001734  4E4F                    2114      TRAP    #15
00001736                          2115      
00001736  143C 0010               2116      MOVE.B  #16,D2
0000173A  103C 000F               2117      MOVE.B  #15,D0
0000173E  220C                    2118      MOVE.L  A4,D1
00001740  4E4F                    2119      TRAP    #15
00001742                          2120  
00001742  6000 F996               2121      BRA     ITERATE
00001746                          2122  
00001746                          2123  DISPLAY_AT_An_DEST
00001746  123C 0028               2124      MOVE.B  #LEFT_PAR,D1
0000174A  103C 0006               2125      MOVE.B  #6,D0
0000174E  4E4F                    2126      TRAP    #15
00001750                          2127  
00001750  123C 0041               2128      MOVE.B  #A,D1
00001754  103C 0006               2129      MOVE.B  #6,D0
00001758  4E4F                    2130      TRAP    #15
0000175A                          2131      
0000175A  143C 0010               2132      MOVE.B  #16,D2
0000175E  103C 000F               2133      MOVE.B  #15,D0
00001762  220C                    2134      MOVE.L  A4,D1
00001764  4E4F                    2135      TRAP    #15
00001766                          2136      
00001766  123C 0029               2137      MOVE.B  #RIGHT_PAR,D1
0000176A  103C 0006               2138      MOVE.B  #6,D0
0000176E  4E4F                    2139      TRAP    #15
00001770                          2140  
00001770  6000 F968               2141      BRA     ITERATE
00001774                          2142  
00001774                          2143  DISPLAY_AT_An_INCREMENT_DEST
00001774  123C 0028               2144      MOVE.B  #LEFT_PAR,D1
00001778  103C 0006               2145      MOVE.B  #6,D0
0000177C  4E4F                    2146      TRAP    #15
0000177E                          2147  
0000177E  123C 0041               2148      MOVE.B  #A,D1
00001782  103C 0006               2149      MOVE.B  #6,D0
00001786  4E4F                    2150      TRAP    #15
00001788                          2151      
00001788  143C 0010               2152      MOVE.B  #16,D2
0000178C  103C 000F               2153      MOVE.B  #15,D0
00001790  220C                    2154      MOVE.L  A4,D1
00001792  4E4F                    2155      TRAP    #15
00001794                          2156      
00001794  123C 0029               2157      MOVE.B  #RIGHT_PAR,D1
00001798  103C 0006               2158      MOVE.B  #6,D0
0000179C  4E4F                    2159      TRAP    #15
0000179E                          2160      
0000179E  123C 002B               2161      MOVE.B  #PLUS,D1
000017A2  103C 0006               2162      MOVE.B  #6,D0
000017A6  4E4F                    2163      TRAP    #15
000017A8                          2164      
000017A8  6000 F930               2165      BRA     ITERATE
000017AC                          2166  
000017AC                          2167  DISPLAY_AT_An_DECREMENT_DEST
000017AC  123C 002D               2168      MOVE.B  #MINUS,D1
000017B0  103C 0006               2169      MOVE.B  #6,D0
000017B4  4E4F                    2170      TRAP    #15
000017B6                          2171  
000017B6  123C 0028               2172      MOVE.B  #LEFT_PAR,D1
000017BA  103C 0006               2173      MOVE.B  #6,D0
000017BE  4E4F                    2174      TRAP    #15
000017C0                          2175  
000017C0  123C 0041               2176      MOVE.B  #A,D1
000017C4  103C 0006               2177      MOVE.B  #6,D0
000017C8  4E4F                    2178      TRAP    #15
000017CA                          2179      
000017CA  143C 0010               2180      MOVE.B  #16,D2
000017CE  103C 000F               2181      MOVE.B  #15,D0
000017D2  220C                    2182      MOVE.L  A4,D1
000017D4  4E4F                    2183      TRAP    #15
000017D6                          2184      
000017D6  123C 0029               2185      MOVE.B  #RIGHT_PAR,D1
000017DA  103C 0006               2186      MOVE.B  #6,D0
000017DE  4E4F                    2187      TRAP    #15
000017E0                          2188  
000017E0  6000 F8F8               2189      BRA     ITERATE
000017E4                          2190  
000017E4                          2191  DISPLAY_ADDRESS_OR_DATA_DEST
000017E4  B8FC 0000               2192      CMP.W   #%000,A4
000017E8  6700 000E               2193      BEQ     DISPLAY_ADDRESS_WORD_DEST
000017EC                          2194      
000017EC  B8FC 0001               2195      CMP.W   #%001,A4
000017F0  6700 0024               2196      BEQ     DISPLAY_ADDRESS_LONG_DEST
000017F4                          2197  
000017F4  6000 F8D4               2198      BRA     IF_INVALID_OP
000017F8                          2199  
000017F8                          2200  DISPLAY_ADDRESS_WORD_DEST
000017F8  544A                    2201      ADDQ    #2,A2
000017FA                          2202      
000017FA  123C 0024               2203      MOVE.B  #HEX,D1
000017FE  103C 0006               2204      MOVE.B  #6,D0
00001802  4E4F                    2205      TRAP    #15
00001804                          2206      
00001804  3212                    2207      MOVE.W  (A2),D1
00001806  C2BC 0000FFFF           2208      AND.L   #$0000FFFF,D1
0000180C  103C 000F               2209      MOVE.B  #15,D0
00001810  4E4F                    2210      TRAP    #15
00001812                          2211      
00001812  6000 F8C6               2212      BRA     ITERATE
00001816                          2213  
00001816                          2214  DISPLAY_ADDRESS_LONG_DEST
00001816  544A                    2215      ADDQ    #2,A2
00001818                          2216      
00001818  123C 0024               2217      MOVE.B  #HEX,D1
0000181C  103C 0006               2218      MOVE.B  #6,D0
00001820  4E4F                    2219      TRAP    #15
00001822                          2220      
00001822  2212                    2221      MOVE.L  (A2),D1
00001824  103C 000F               2222      MOVE.B  #15,D0
00001828  4E4F                    2223      TRAP    #15
0000182A                          2224      
0000182A  544A                    2225      ADDQ    #2,A2
0000182C                          2226  
0000182C  6000 F8AC               2227      BRA     ITERATE
00001830                          2228  
00001830                          2229  
00001830                          2230  
00001830                          2231  
00001830                          2232  
00001830                          2233  
00001830                          2234  
00001830                          2235  -------------------- end include --------------------
00001830                          2236          INCLUDE ADD_ADDA.X68
00001830                          2237  
00001840                          2238      ORG     $1840
00001840                          2239      
00001840                          2240  IF_ADD_ADDA
00001840  360C                    2241      MOVE.W  A4,D3
00001842                          2242      
00001842                          2243      ;Get the register
00001842  C67C 0FFF               2244      AND.W   #$0FFF,D3
00001846  E743                    2245      ASL.W   #3,D3
00001848  3803                    2246      MOVE.W  D3,D4
0000184A  C8BC 0000F000           2247      AND.L   #$0000F000,D4
00001850  E95C                    2248      ROL.W   #4,D4
00001852  2844                    2249      MOVE.L  D4,A4 ;register
00001854                          2250  
00001854                          2251      ;Get the opmode
00001854  C67C 0FFF               2252      AND.W   #$0FFF,D3
00001858  E743                    2253      ASL.W   #3,D3
0000185A  3803                    2254      MOVE.W  D3,D4
0000185C  C8BC 0000F000           2255      AND.L   #$0000F000,D4
00001862  E95C                    2256      ROL.W   #4,D4
00001864  2A44                    2257      MOVE.L  D4,A5 ;opmode
00001866                          2258  
00001866                          2259      ;Get the effective mode 
00001866  C67C 0FFF               2260      AND.W   #$0FFF,D3
0000186A  E743                    2261      ASL.W   #3,D3
0000186C  3803                    2262      MOVE.W  D3,D4
0000186E  C8BC 0000F000           2263      AND.L   #$0000F000,D4
00001874  E95C                    2264      ROL.W   #4,D4
00001876  2C44                    2265      MOVE.L  D4,A6 ;effective mode
00001878                          2266      
00001878                          2267      ;Get the effective register
00001878  C67C 0FFF               2268      AND.W   #$0FFF,D3
0000187C  E743                    2269      ASL.W   #3,D3
0000187E  3803                    2270      MOVE.W  D3,D4
00001880  C8BC 0000F000           2271      AND.L   #$0000F000,D4
00001886  E95C                    2272      ROL.W   #4,D4 ;effective register
00001888                          2273      
00001888  143C 0010               2274      MOVE.B  #16,D2
0000188C  103C 000F               2275      MOVE.B  #15,D0
00001890                          2276      
00001890  6000 0002               2277      BRA     DISPLAY_ADD_ADDA
00001894                          2278      
00001894                          2279  DISPLAY_ADD_ADDA
00001894  BAFC 0003               2280      CMP.W   #%011,A5
00001898  6700 000E               2281      BEQ     DISPLAY_ADDA_W
0000189C                          2282      
0000189C  BAFC 0007               2283      CMP.W   #%111,A5
000018A0  6700 0026               2284      BEQ     DISPLAY_ADDA_L
000018A4                          2285      
000018A4  6000 0234               2286      BRA     DISPLAY_ADD
000018A8                          2287  
000018A8                          2288  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000018A8                          2289  
000018A8                          2290  DISPLAY_ADDA_W
000018A8  43F9 00001113           2291      LEA     ADDA_OUTPUT,A1
000018AE  103C 000E               2292      MOVE.B  #14,D0
000018B2  4E4F                    2293      TRAP    #15
000018B4                          2294  
000018B4  43F9 00001180           2295      LEA     W_OUTPUT,A1
000018BA  103C 000E               2296      MOVE.B  #14,D0
000018BE  4E4F                    2297      TRAP    #15
000018C0                          2298      
000018C0  6100 0026               2299      BSR     GET_EFFECTIVE_ADDRESS_ea
000018C4  6000 01F0               2300      BRA     DISPLAY_ADDA_REGISTER
000018C8                          2301  
000018C8                          2302  DISPLAY_ADDA_L
000018C8  43F9 00001113           2303      LEA     ADDA_OUTPUT,A1
000018CE  103C 000E               2304      MOVE.B  #14,D0
000018D2  4E4F                    2305      TRAP    #15
000018D4                          2306      
000018D4  43F9 00001184           2307      LEA     L_OUTPUT,A1
000018DA  103C 000E               2308      MOVE.B  #14,D0
000018DE  4E4F                    2309      TRAP    #15
000018E0                          2310      
000018E0  6100 0006               2311      BSR     GET_EFFECTIVE_ADDRESS_ea
000018E4  6000 01D0               2312      BRA     DISPLAY_ADDA_REGISTER
000018E8                          2313      
000018E8                          2314  ;subroutine;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000018E8                          2315  GET_EFFECTIVE_ADDRESS_ea
000018E8  BCFC 0000               2316      CMP.W   #%000,A6
000018EC  6700 002E               2317      BEQ     DISPLAY_Dn_ea
000018F0                          2318      
000018F0  BCFC 0001               2319      CMP.W   #%001,A6
000018F4  6700 003E               2320      BEQ     DISPLAY_An_ea
000018F8                          2321      
000018F8  BCFC 0002               2322      CMP.W   #%010,A6
000018FC  6700 004E               2323      BEQ     DISPLAY_An_ADDRESS_ea
00001900                          2324      
00001900  BCFC 0003               2325      CMP.W   #%011,A6
00001904  6700 0072               2326      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
00001908                          2327      
00001908  BCFC 0004               2328      CMP.W   #%100,A6
0000190C  6700 00A0               2329      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
00001910                          2330      
00001910  BCFC 0007               2331      CMP.W   #%111,A6
00001914  6700 00CE               2332      BEQ     DISPLAY_ADDRESS_OR_DATA_ea
00001918                          2333      
00001918  6000 F7B0               2334      BRA     IF_INVALID_OP
0000191C                          2335  
0000191C                          2336  DISPLAY_Dn_ea
0000191C  123C 0044               2337      MOVE.B  #D,D1
00001920  103C 0006               2338      MOVE.B  #6,D0
00001924  4E4F                    2339      TRAP    #15
00001926                          2340      
00001926  143C 0010               2341      MOVE.B  #16,D2
0000192A  103C 000F               2342      MOVE.B  #15,D0
0000192E  2204                    2343      MOVE.L  D4,D1
00001930  4E4F                    2344      TRAP    #15
00001932                          2345      
00001932  4E75                    2346      RTS
00001934                          2347  
00001934                          2348  DISPLAY_An_ea
00001934  123C 0041               2349      MOVE.B  #A,D1
00001938  103C 0006               2350      MOVE.B  #6,D0
0000193C  4E4F                    2351      TRAP    #15
0000193E                          2352      
0000193E  143C 0010               2353      MOVE.B  #16,D2
00001942  103C 000F               2354      MOVE.B  #15,D0
00001946  2204                    2355      MOVE.L  D4,D1
00001948                          2356      
00001948  4E4F                    2357      TRAP    #15
0000194A                          2358      
0000194A  4E75                    2359      RTS
0000194C                          2360  
0000194C                          2361  DISPLAY_An_ADDRESS_ea
0000194C  123C 0028               2362      MOVE.B  #LEFT_PAR,D1
00001950  103C 0006               2363      MOVE.B  #6,D0
00001954  4E4F                    2364      TRAP    #15
00001956                          2365  
00001956  123C 0041               2366      MOVE.B  #A,D1
0000195A  103C 0006               2367      MOVE.B  #6,D0
0000195E  4E4F                    2368      TRAP    #15
00001960                          2369      
00001960  143C 0010               2370      MOVE.B  #16,D2
00001964  103C 000F               2371      MOVE.B  #15,D0
00001968  2204                    2372      MOVE.L  D4,D1
0000196A                          2373      
0000196A  4E4F                    2374      TRAP    #15
0000196C                          2375      
0000196C  123C 0029               2376      MOVE.B  #RIGHT_PAR,D1
00001970  103C 0006               2377      MOVE.B  #6,D0
00001974  4E4F                    2378      TRAP    #15
00001976                          2379      
00001976  4E75                    2380      RTS
00001978                          2381  
00001978                          2382  DISPLAY_An_ADDRESS_INCREMENT_ea
00001978  123C 0028               2383      MOVE.B  #LEFT_PAR,D1
0000197C  103C 0006               2384      MOVE.B  #6,D0
00001980  4E4F                    2385      TRAP    #15
00001982                          2386  
00001982  123C 0041               2387      MOVE.B  #A,D1
00001986  103C 0006               2388      MOVE.B  #6,D0
0000198A  4E4F                    2389      TRAP    #15
0000198C                          2390      
0000198C  143C 0010               2391      MOVE.B  #16,D2
00001990  103C 000F               2392      MOVE.B  #15,D0
00001994  2204                    2393      MOVE.L  D4,D1
00001996                          2394      
00001996  4E4F                    2395      TRAP    #15
00001998                          2396      
00001998  123C 0029               2397      MOVE.B  #RIGHT_PAR,D1
0000199C  103C 0006               2398      MOVE.B  #6,D0
000019A0  4E4F                    2399      TRAP    #15
000019A2                          2400      
000019A2  123C 002B               2401      MOVE.B  #PLUS,D1
000019A6  103C 0006               2402      MOVE.B  #6,D0
000019AA  4E4F                    2403      TRAP    #15
000019AC                          2404      
000019AC  4E75                    2405      RTS
000019AE                          2406  
000019AE                          2407  DISPLAY_An_ADDRESS_DECREMENT_ea
000019AE  123C 002D               2408      MOVE.B  #MINUS,D1
000019B2  103C 0006               2409      MOVE.B  #6,D0
000019B6  4E4F                    2410      TRAP    #15
000019B8                          2411  
000019B8  123C 0028               2412      MOVE.B  #LEFT_PAR,D1
000019BC  103C 0006               2413      MOVE.B  #6,D0
000019C0  4E4F                    2414      TRAP    #15
000019C2                          2415  
000019C2  123C 0041               2416      MOVE.B  #A,D1
000019C6  103C 0006               2417      MOVE.B  #6,D0
000019CA  4E4F                    2418      TRAP    #15
000019CC                          2419      
000019CC  143C 0010               2420      MOVE.B  #16,D2
000019D0  103C 000F               2421      MOVE.B  #15,D0
000019D4  2204                    2422      MOVE.L  D4,D1
000019D6                          2423      
000019D6  4E4F                    2424      TRAP    #15
000019D8                          2425      
000019D8  123C 0029               2426      MOVE.B  #RIGHT_PAR,D1
000019DC  103C 0006               2427      MOVE.B  #6,D0
000019E0  4E4F                    2428      TRAP    #15
000019E2                          2429      
000019E2  4E75                    2430      RTS
000019E4                          2431  
000019E4                          2432  DISPLAY_ADDRESS_OR_DATA_ea
000019E4  B87C 0000               2433      CMP.W   #%000,D4
000019E8  6700 0016               2434      BEQ     DISPLAY_ADDRESS_WORD_ea
000019EC                          2435      
000019EC  B87C 0001               2436      CMP.W   #%001,D4
000019F0  6700 002A               2437      BEQ     DISPLAY_ADDRESS_LONG_ea
000019F4                          2438      
000019F4  B87C 0004               2439      CMP.W   #%100,D4
000019F8  6700 003A               2440      BEQ     DISPLAY_DATA_ea
000019FC                          2441      
000019FC  6000 F6CC               2442      BRA     IF_INVALID_OP
00001A00                          2443      
00001A00                          2444  DISPLAY_ADDRESS_WORD_ea
00001A00  544A                    2445      ADDQ    #2,A2
00001A02                          2446      
00001A02  123C 0024               2447      MOVE.B  #HEX,D1
00001A06  103C 0006               2448      MOVE.B  #6,D0
00001A0A  4E4F                    2449      TRAP    #15
00001A0C                          2450      
00001A0C  3212                    2451      MOVE.W  (A2),D1
00001A0E  C2BC 0000FFFF           2452      AND.L   #$0000FFFF,D1
00001A14  103C 000F               2453      MOVE.B  #15,D0
00001A18  4E4F                    2454      TRAP    #15
00001A1A                          2455      
00001A1A  4E75                    2456      RTS
00001A1C                          2457  
00001A1C                          2458  DISPLAY_ADDRESS_LONG_ea
00001A1C  544A                    2459      ADDQ    #2,A2
00001A1E                          2460      
00001A1E  123C 0024               2461      MOVE.B  #HEX,D1
00001A22  103C 0006               2462      MOVE.B  #6,D0
00001A26  4E4F                    2463      TRAP    #15
00001A28                          2464      
00001A28  2212                    2465      MOVE.L  (A2),D1
00001A2A  103C 000F               2466      MOVE.B  #15,D0
00001A2E  4E4F                    2467      TRAP    #15
00001A30                          2468      
00001A30  544A                    2469      ADDQ    #2,A2
00001A32                          2470      
00001A32  4E75                    2471      RTS
00001A34                          2472      
00001A34                          2473  DISPLAY_DATA_ea
00001A34  BAFC 0003               2474      CMP.W   #%011,A5
00001A38  6700 0034               2475      BEQ     DISPLAY_DATA_WORD_ea
00001A3C                          2476      
00001A3C  BAFC 0007               2477      CMP.W   #%111,A5
00001A40  6700 0052               2478      BEQ     DISPLAY_DATA_LONG_ea
00001A44                          2479  
00001A44  6000 F684               2480      BRA     IF_INVALID_OP
00001A48                          2481  
00001A48                          2482  DISPLAY_DATA_BYTE_ea
00001A48  544A                    2483      ADDQ    #2,A2
00001A4A                          2484      
00001A4A  123C 0023               2485      MOVE.B  #NUM,D1
00001A4E  103C 0006               2486      MOVE.B  #6,D0
00001A52  4E4F                    2487      TRAP    #15
00001A54                          2488      
00001A54  123C 0024               2489      MOVE.B  #HEX,D1
00001A58  103C 0006               2490      MOVE.B  #6,D0
00001A5C  4E4F                    2491      TRAP    #15
00001A5E                          2492      
00001A5E  3212                    2493      MOVE.W  (A2),D1
00001A60  C2BC 000000FF           2494      AND.L   #$000000FF,D1
00001A66  103C 000F               2495      MOVE.B  #15,D0
00001A6A  4E4F                    2496      TRAP    #15
00001A6C  4E75                    2497      RTS
00001A6E                          2498  
00001A6E                          2499  DISPLAY_DATA_WORD_ea
00001A6E  544A                    2500      ADDQ    #2,A2
00001A70                          2501      
00001A70  123C 0023               2502      MOVE.B  #NUM,D1
00001A74  103C 0006               2503      MOVE.B  #6,D0
00001A78  4E4F                    2504      TRAP    #15
00001A7A                          2505      
00001A7A  123C 0024               2506      MOVE.B  #HEX,D1
00001A7E  103C 0006               2507      MOVE.B  #6,D0
00001A82  4E4F                    2508      TRAP    #15
00001A84                          2509      
00001A84  3212                    2510      MOVE.W  (A2),D1
00001A86  C2BC 0000FFFF           2511      AND.L   #$0000FFFF,D1
00001A8C  103C 000F               2512      MOVE.B  #15,D0
00001A90  4E4F                    2513      TRAP    #15
00001A92  4E75                    2514      RTS
00001A94                          2515      
00001A94                          2516  DISPLAY_DATA_LONG_ea
00001A94  544A                    2517      ADDQ    #2,A2
00001A96                          2518      
00001A96  123C 0023               2519      MOVE.B  #NUM,D1
00001A9A  103C 0006               2520      MOVE.B  #6,D0
00001A9E  4E4F                    2521      TRAP    #15
00001AA0                          2522      
00001AA0  123C 0024               2523      MOVE.B  #HEX,D1
00001AA4  103C 0006               2524      MOVE.B  #6,D0
00001AA8  4E4F                    2525      TRAP    #15
00001AAA                          2526      
00001AAA  2212                    2527      MOVE.L  (A2),D1
00001AAC  103C 000F               2528      MOVE.B  #15,D0
00001AB0  4E4F                    2529      TRAP    #15
00001AB2                          2530      
00001AB2  544A                    2531      ADDQ    #2,A2
00001AB4                          2532      
00001AB4  4E75                    2533      RTS
00001AB6                          2534  
00001AB6                          2535  
00001AB6                          2536  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001AB6                          2537   
00001AB6                          2538  DISPLAY_ADDA_REGISTER
00001AB6  123C 002C               2539      MOVE.B  #COMMA,D1
00001ABA  103C 0006               2540      MOVE.B  #6,D0
00001ABE  4E4F                    2541      TRAP    #15
00001AC0                          2542  
00001AC0  123C 0041               2543      MOVE.B  #A,D1
00001AC4  103C 0006               2544      MOVE.B  #6,D0
00001AC8  4E4F                    2545      TRAP    #15
00001ACA                          2546      
00001ACA  143C 0010               2547      MOVE.B  #16,D2
00001ACE  103C 000F               2548      MOVE.B  #15,D0
00001AD2  220C                    2549      MOVE.L  A4,D1
00001AD4  4E4F                    2550      TRAP    #15
00001AD6                          2551      
00001AD6  6000 F602               2552      BRA     ITERATE
00001ADA                          2553      
00001ADA                          2554  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001ADA                          2555      
00001ADA                          2556  
00001ADA                          2557  DISPLAY_ADD
00001ADA  43F9 00001118           2558      LEA     ADD_OUTPUT,A1
00001AE0  103C 000E               2559      MOVE.B  #14,D0
00001AE4  4E4F                    2560      TRAP    #15
00001AE6                          2561      
00001AE6  6000 0002               2562      BRA     DISPLAY_ARGS
00001AEA                          2563      
00001AEA                          2564  DISPLAY_ARGS    
00001AEA                          2565      
00001AEA  BAFC 0000               2566      CMP.W   #%000,A5
00001AEE  6700 002E               2567      BEQ     DISPLAY_BYTE_SRC
00001AF2                          2568      
00001AF2  BAFC 0001               2569      CMP.W   #%001,A5
00001AF6  6700 0048               2570      BEQ     DISPLAY_WORD_SRC
00001AFA                          2571      
00001AFA  BAFC 0002               2572      CMP.W   #%010,A5
00001AFE  6700 0062               2573      BEQ     DISPLAY_LONG_SRC
00001B02                          2574      
00001B02  BAFC 0004               2575      CMP.W   #%100,A5
00001B06  6700 007C               2576      BEQ     DISPLAY_BYTE_DEST
00001B0A                          2577      
00001B0A  BAFC 0005               2578      CMP.W   #%101,A5
00001B0E  6700 0096               2579      BEQ     DISPLAY_WORD_DEST
00001B12                          2580      
00001B12  BAFC 0006               2581      CMP.W   #%110,A5
00001B16  6700 00B0               2582      BEQ     DISPLAY_LONG_DEST
00001B1A                          2583      
00001B1A  6000 F5AE               2584      BRA     IF_INVALID_OP   
00001B1E                          2585      
00001B1E                          2586  DISPLAY_BYTE_SRC
00001B1E  43F9 0000117C           2587      LEA     B_OUTPUT,A1
00001B24  103C 000E               2588      MOVE.B  #14,D0
00001B28  4E4F                    2589      TRAP    #15
00001B2A                          2590  
00001B2A  6100 FDBC               2591      BSR     GET_EFFECTIVE_ADDRESS_ea
00001B2E                          2592      
00001B2E  123C 002C               2593      MOVE.B  #COMMA,D1
00001B32  103C 0006               2594      MOVE.B  #6,D0
00001B36  4E4F                    2595      TRAP    #15
00001B38                          2596      
00001B38  6100 00B0               2597      BSR     DISPLAY_Dn_ADD
00001B3C                          2598      
00001B3C  6000 F59C               2599      BRA     ITERATE
00001B40                          2600  
00001B40                          2601  DISPLAY_WORD_SRC
00001B40  43F9 00001180           2602      LEA     W_OUTPUT,A1
00001B46  103C 000E               2603      MOVE.B  #14,D0
00001B4A  4E4F                    2604      TRAP    #15
00001B4C                          2605  
00001B4C  6100 FD9A               2606      BSR     GET_EFFECTIVE_ADDRESS_ea
00001B50                          2607  
00001B50  123C 002C               2608      MOVE.B  #COMMA,D1
00001B54  103C 0006               2609      MOVE.B  #6,D0
00001B58  4E4F                    2610      TRAP    #15    
00001B5A                          2611  
00001B5A  6100 008E               2612      BSR     DISPLAY_Dn_ADD
00001B5E                          2613      
00001B5E  6000 F57A               2614      BRA     ITERATE
00001B62                          2615  
00001B62                          2616  DISPLAY_LONG_SRC
00001B62  43F9 00001184           2617      LEA     L_OUTPUT,A1
00001B68  103C 000E               2618      MOVE.B  #14,D0
00001B6C  4E4F                    2619      TRAP    #15
00001B6E                          2620  
00001B6E  6100 FD78               2621      BSR     GET_EFFECTIVE_ADDRESS_ea
00001B72                          2622  
00001B72  123C 002C               2623      MOVE.B  #COMMA,D1
00001B76  103C 0006               2624      MOVE.B  #6,D0
00001B7A  4E4F                    2625      TRAP    #15    
00001B7C                          2626  
00001B7C  6100 006C               2627      BSR     DISPLAY_Dn_ADD
00001B80                          2628      
00001B80  6000 F558               2629      BRA     ITERATE
00001B84                          2630  
00001B84                          2631  DISPLAY_BYTE_DEST
00001B84  43F9 0000117C           2632      LEA     B_OUTPUT,A1
00001B8A  103C 000E               2633      MOVE.B  #14,D0
00001B8E  4E4F                    2634      TRAP    #15
00001B90                          2635  
00001B90  6100 0058               2636      BSR     DISPLAY_Dn_ADD
00001B94                          2637      
00001B94  123C 002C               2638      MOVE.B  #COMMA,D1
00001B98  103C 0006               2639      MOVE.B  #6,D0
00001B9C  4E4F                    2640      TRAP    #15    
00001B9E                          2641  
00001B9E  6100 0062               2642      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00001BA2                          2643      
00001BA2  6000 F536               2644      BRA     ITERATE
00001BA6                          2645  
00001BA6                          2646  DISPLAY_WORD_DEST
00001BA6  43F9 00001180           2647      LEA     W_OUTPUT,A1
00001BAC  103C 000E               2648      MOVE.B  #14,D0
00001BB0  4E4F                    2649      TRAP    #15
00001BB2                          2650  
00001BB2  6100 0036               2651      BSR     DISPLAY_Dn_ADD
00001BB6                          2652      
00001BB6  123C 002C               2653      MOVE.B  #COMMA,D1
00001BBA  103C 0006               2654      MOVE.B  #6,D0
00001BBE  4E4F                    2655      TRAP    #15    
00001BC0                          2656  
00001BC0  6100 0040               2657      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00001BC4                          2658      
00001BC4  6000 F514               2659      BRA     ITERATE
00001BC8                          2660  
00001BC8                          2661  DISPLAY_LONG_DEST
00001BC8  43F9 00001184           2662      LEA     L_OUTPUT,A1
00001BCE  103C 000E               2663      MOVE.B  #14,D0
00001BD2  4E4F                    2664      TRAP    #15
00001BD4                          2665  
00001BD4  6100 0014               2666      BSR     DISPLAY_Dn_ADD
00001BD8                          2667      
00001BD8  123C 002C               2668      MOVE.B  #COMMA,D1
00001BDC  103C 0006               2669      MOVE.B  #6,D0
00001BE0  4E4F                    2670      TRAP    #15    
00001BE2                          2671  
00001BE2  6100 001E               2672      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00001BE6                          2673      
00001BE6  6000 F4F2               2674      BRA     ITERATE
00001BEA                          2675      
00001BEA                          2676  DISPLAY_Dn_ADD
00001BEA  123C 0044               2677      MOVE.B  #D,D1
00001BEE  103C 0006               2678      MOVE.B  #6,D0
00001BF2  4E4F                    2679      TRAP    #15
00001BF4                          2680      
00001BF4  143C 0010               2681      MOVE.B  #16,D2
00001BF8  103C 000F               2682      MOVE.B  #15,D0
00001BFC  220C                    2683      MOVE.L  A4,D1
00001BFE  4E4F                    2684      TRAP    #15
00001C00                          2685      
00001C00  4E75                    2686      RTS
00001C02                          2687  
00001C02                          2688  ;subroutine;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001C02                          2689  GET_EFFECTIVE_ADDRESS_ea_DEST   
00001C02  BCFC 0002               2690      CMP.W   #%010,A6
00001C06  6700 FD44               2691      BEQ     DISPLAY_An_ADDRESS_ea
00001C0A                          2692      
00001C0A  BCFC 0003               2693      CMP.W   #%011,A6
00001C0E  6700 FD68               2694      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
00001C12                          2695      
00001C12  BCFC 0004               2696      CMP.W   #%100,A6
00001C16  6700 FD96               2697      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
00001C1A                          2698      
00001C1A  BCFC 0007               2699      CMP.W   #%111,A6
00001C1E  6700 FDC4               2700      BEQ     DISPLAY_ADDRESS_OR_DATA_ea
00001C22                          2701      
00001C22  6000 F4A6               2702      BRA     IF_INVALID_OP
00001C26                          2703  
00001C26                          2704  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001C26                          2705  
00001C26                          2706      
00001C26                          2707      
00001C26                          2708  
00001C26                          2709  
00001C26                          2710  
00001C26                          2711  
00001C26                          2712  
00001C26                          2713  -------------------- end include --------------------
00001C26                          2714          INCLUDE SUB.X68
00003940                          2715      ORG    $3940
00003940                          2716  
00003940                          2717  IF_SUB 
00003940  360C                    2718      MOVE.W  A4,D3
00003942                          2719      
00003942                          2720      ;Get the register
00003942  C67C 0FFF               2721      AND.W   #$0FFF,D3
00003946  E743                    2722      ASL.W   #3,D3
00003948  3803                    2723      MOVE.W  D3,D4
0000394A  C8BC 0000F000           2724      AND.L   #$0000F000,D4
00003950  E95C                    2725      ROL.W   #4,D4
00003952  2844                    2726      MOVE.L  D4,A4 ;register
00003954                          2727  
00003954                          2728      ;Get the opmode
00003954  C67C 0FFF               2729      AND.W   #$0FFF,D3
00003958  E743                    2730      ASL.W   #3,D3
0000395A  3803                    2731      MOVE.W  D3,D4
0000395C  C8BC 0000F000           2732      AND.L   #$0000F000,D4
00003962  E95C                    2733      ROL.W   #4,D4
00003964  2A44                    2734      MOVE.L  D4,A5 ;opmode
00003966                          2735  
00003966                          2736      ;Get the effective mode 
00003966  C67C 0FFF               2737      AND.W   #$0FFF,D3
0000396A  E743                    2738      ASL.W   #3,D3
0000396C  3803                    2739      MOVE.W  D3,D4
0000396E  C8BC 0000F000           2740      AND.L   #$0000F000,D4
00003974  E95C                    2741      ROL.W   #4,D4
00003976  2C44                    2742      MOVE.L  D4,A6 ;effective mode
00003978                          2743      
00003978                          2744      ;Get the effective register
00003978  C67C 0FFF               2745      AND.W   #$0FFF,D3
0000397C  E743                    2746      ASL.W   #3,D3
0000397E  3803                    2747      MOVE.W  D3,D4
00003980  C8BC 0000F000           2748      AND.L   #$0000F000,D4
00003986  E95C                    2749      ROL.W   #4,D4 ;effective register
00003988                          2750      
00003988  143C 0010               2751      MOVE.B  #16,D2
0000398C  103C 000F               2752      MOVE.B  #15,D0
00003990                          2753      
00003990  6000 0002               2754      BRA     DISPLAY_SUB
00003994                          2755      
00003994                          2756  DISPLAY_SUB
00003994  43F9 0000111C           2757      LEA     SUB_OUTPUT,A1
0000399A  103C 000E               2758      MOVE.B  #14,D0
0000399E  4E4F                    2759      TRAP    #15
000039A0                          2760      
000039A0  6000 E148               2761      BRA     DISPLAY_ARGS
000039A4                          2762  
000039A4                          2763  
000039A4                          2764  -------------------- end include --------------------
000039A4                          2765          INCLUDE ADDQ.X68
00001C60                          2766      ORG    $1C60
00001C60                          2767  
00001C60                          2768  IF_ADDQ 
00001C60  360C                    2769      MOVE.W  A4,D3
00001C62                          2770      
00001C62                          2771      ;Get the register
00001C62  C67C 0FFF               2772      AND.W   #$0FFF,D3
00001C66  E743                    2773      ASL.W   #3,D3
00001C68  3803                    2774      MOVE.W  D3,D4
00001C6A  C8BC 0000F000           2775      AND.L   #$0000F000,D4
00001C70  E95C                    2776      ROL.W   #4,D4
00001C72  2844                    2777      MOVE.L  D4,A4 ;data
00001C74                          2778      
00001C74  6100 0118               2779      BSR     CHECK_FOR_EIGHT
00001C78                          2780  
00001C78                          2781      ;Get the opmode
00001C78  C67C 0FFF               2782      AND.W   #$0FFF,D3
00001C7C  E743                    2783      ASL.W   #3,D3
00001C7E  3803                    2784      MOVE.W  D3,D4
00001C80  C8BC 0000F000           2785      AND.L   #$0000F000,D4
00001C86  E95C                    2786      ROL.W   #4,D4
00001C88  2A44                    2787      MOVE.L  D4,A5 ;size
00001C8A                          2788  
00001C8A                          2789      ;Get the effective mode 
00001C8A  C67C 0FFF               2790      AND.W   #$0FFF,D3
00001C8E  E743                    2791      ASL.W   #3,D3
00001C90  3803                    2792      MOVE.W  D3,D4
00001C92  C8BC 0000F000           2793      AND.L   #$0000F000,D4
00001C98  E95C                    2794      ROL.W   #4,D4
00001C9A  2C44                    2795      MOVE.L  D4,A6 ;effective mode
00001C9C                          2796      
00001C9C                          2797      ;Get the effective register
00001C9C  C67C 0FFF               2798      AND.W   #$0FFF,D3
00001CA0  E743                    2799      ASL.W   #3,D3
00001CA2  3803                    2800      MOVE.W  D3,D4
00001CA4  C8BC 0000F000           2801      AND.L   #$0000F000,D4
00001CAA  E95C                    2802      ROL.W   #4,D4 ;effective register
00001CAC                          2803      
00001CAC  143C 0010               2804      MOVE.B  #16,D2
00001CB0  103C 000F               2805      MOVE.B  #15,D0
00001CB4                          2806      
00001CB4  6000 0002               2807      BRA     DISPLAY_ADDQ
00001CB8                          2808      
00001CB8                          2809  DISPLAY_ADDQ
00001CB8  43F9 00001120           2810      LEA     ADDQ_OUTPUT,A1
00001CBE  103C 000E               2811      MOVE.B  #14,D0
00001CC2  4E4F                    2812      TRAP    #15
00001CC4                          2813  
00001CC4  6000 0002               2814      BRA     DISPLAY_ADDQ_SIZE
00001CC8                          2815  
00001CC8                          2816  DISPLAY_ADDQ_SIZE
00001CC8  BAFC 0000               2817      CMP.W   #%00,A5
00001CCC  6700 0016               2818      BEQ     DISPLAY_ADDQ_BYTE
00001CD0                          2819      
00001CD0  BAFC 0001               2820      CMP.W   #%01,A5
00001CD4  6700 001E               2821      BEQ     DISPLAY_ADDQ_WORD
00001CD8                          2822      
00001CD8  BAFC 0002               2823      CMP.W   #%10,A5
00001CDC  6700 0026               2824      BEQ     DISPLAY_ADDQ_LONG
00001CE0                          2825      
00001CE0  6000 F3E8               2826      BRA     IF_INVALID_OP
00001CE4                          2827  
00001CE4                          2828  DISPLAY_ADDQ_BYTE
00001CE4  43F9 0000117C           2829      LEA     B_OUTPUT,A1
00001CEA  103C 000E               2830      MOVE.B  #14,D0
00001CEE  4E4F                    2831      TRAP    #15
00001CF0  6000 0022               2832      BRA     DISPLAY_ADDQ_COMMA
00001CF4                          2833  
00001CF4                          2834  DISPLAY_ADDQ_WORD
00001CF4  43F9 00001180           2835      LEA     W_OUTPUT,A1
00001CFA  103C 000E               2836      MOVE.B  #14,D0
00001CFE  4E4F                    2837      TRAP    #15
00001D00  6000 0012               2838      BRA     DISPLAY_ADDQ_COMMA
00001D04                          2839  
00001D04                          2840  DISPLAY_ADDQ_LONG
00001D04  43F9 00001184           2841      LEA     L_OUTPUT,A1
00001D0A  103C 000E               2842      MOVE.B  #14,D0
00001D0E  4E4F                    2843      TRAP    #15
00001D10  6000 0002               2844      BRA     DISPLAY_ADDQ_COMMA    
00001D14                          2845      
00001D14                          2846  DISPLAY_ADDQ_COMMA
00001D14  123C 0023               2847      MOVE.B  #NUM,D1
00001D18  103C 0006               2848      MOVE.B  #6,D0
00001D1C  4E4F                    2849      TRAP    #15
00001D1E                          2850      
00001D1E  123C 0024               2851      MOVE.B  #HEX,D1
00001D22  103C 0006               2852      MOVE.B  #6,D0
00001D26  4E4F                    2853      TRAP    #15
00001D28                          2854  
00001D28  143C 0010               2855      MOVE.B  #16,D2
00001D2C  103C 000F               2856      MOVE.B  #15,D0
00001D30  220C                    2857      MOVE.L  A4,D1
00001D32  4E4F                    2858      TRAP    #15
00001D34                          2859  
00001D34  123C 002C               2860      MOVE.B  #COMMA,D1
00001D38  103C 0006               2861      MOVE.B  #6,D0
00001D3C  4E4F                    2862      TRAP    #15
00001D3E                          2863      
00001D3E  6100 FBA8               2864      BSR     GET_EFFECTIVE_ADDRESS_ea
00001D42  6000 F396               2865      BRA     ITERATE
00001D46                          2866  
00001D46                          2867  ;subroutine;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001D46                          2868  GET_EFFECTIVE_ADDRESS_ea_NO_DATA
00001D46  BCFC 0000               2869      CMP.W   #%000,A6
00001D4A  6700 FBD0               2870      BEQ     DISPLAY_Dn_ea
00001D4E                          2871      
00001D4E  BCFC 0001               2872      CMP.W   #%001,A6
00001D52  6700 FBE0               2873      BEQ     DISPLAY_An_ea
00001D56                          2874      
00001D56  BCFC 0002               2875      CMP.W   #%010,A6
00001D5A  6700 FBF0               2876      BEQ     DISPLAY_An_ADDRESS_ea
00001D5E                          2877      
00001D5E  BCFC 0003               2878      CMP.W   #%011,A6
00001D62  6700 FC14               2879      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
00001D66                          2880      
00001D66  BCFC 0004               2881      CMP.W   #%100,A6
00001D6A  6700 FC42               2882      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
00001D6E                          2883      
00001D6E  BCFC 0007               2884      CMP.W   #%111,A6
00001D72  6700 0006               2885      BEQ     DISPLAY_ADDRESS_ea
00001D76                          2886      
00001D76  6000 F352               2887      BRA     IF_INVALID_OP
00001D7A                          2888  
00001D7A                          2889  DISPLAY_ADDRESS_ea
00001D7A  BCFC 0000               2890      CMP.W   #%000,A6
00001D7E  6700 FC80               2891      BEQ     DISPLAY_ADDRESS_WORD_ea
00001D82                          2892      
00001D82  BCFC 0001               2893      CMP.W   #%001,A6
00001D86  6700 FC94               2894      BEQ     DISPLAY_ADDRESS_LONG_ea
00001D8A                          2895      
00001D8A  6000 F33E               2896      BRA     IF_INVALID_OP
00001D8E                          2897      
00001D8E                          2898  
00001D8E                          2899  ;subroutine;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00001D8E                          2900  CHECK_FOR_EIGHT
00001D8E  B8FC 0000               2901      CMP.W   #$0,A4
00001D92  6700 0004               2902      BEQ     SET_TO_EIGHT 
00001D96  4E75                    2903      RTS
00001D98                          2904  
00001D98                          2905  SET_TO_EIGHT
00001D98  287C 00000008           2906      MOVE.L  #$8,A4
00001D9E  4E75                    2907      RTS
00001DA0                          2908      
00001DA0                          2909      
00001DA0                          2910  
00001DA0                          2911  
00001DA0                          2912  
00001DA0                          2913  
00001DA0                          2914  -------------------- end include --------------------
00001DA0                          2915          INCLUDE MULS_AND.X68
00003520                          2916      ORG    $3520
00003520                          2917  IF_MULS_AND
00003520  360C                    2918      MOVE.W  A4,D3
00003522                          2919      
00003522                          2920      ;Get the register
00003522  C67C 0FFF               2921      AND.W   #$0FFF,D3
00003526  E743                    2922      ASL.W   #3,D3
00003528  3803                    2923      MOVE.W  D3,D4
0000352A  C8BC 0000F000           2924      AND.L   #$0000F000,D4
00003530  E95C                    2925      ROL.W   #4,D4
00003532  2844                    2926      MOVE.L  D4,A4 ;register
00003534                          2927  
00003534                          2928      ;Get the opmode
00003534  C67C 0FFF               2929      AND.W   #$0FFF,D3
00003538  E743                    2930      ASL.W   #3,D3
0000353A  3803                    2931      MOVE.W  D3,D4
0000353C  C8BC 0000F000           2932      AND.L   #$0000F000,D4
00003542  E95C                    2933      ROL.W   #4,D4
00003544  2A44                    2934      MOVE.L  D4,A5 ;opmode
00003546                          2935  
00003546                          2936      ;Get the effective mode 
00003546  C67C 0FFF               2937      AND.W   #$0FFF,D3
0000354A  E743                    2938      ASL.W   #3,D3
0000354C  3803                    2939      MOVE.W  D3,D4
0000354E  C8BC 0000F000           2940      AND.L   #$0000F000,D4
00003554  E95C                    2941      ROL.W   #4,D4
00003556  2C44                    2942      MOVE.L  D4,A6 ;effective mode
00003558                          2943      
00003558                          2944      ;Get the effective register
00003558  C67C 0FFF               2945      AND.W   #$0FFF,D3
0000355C  E743                    2946      ASL.W   #3,D3
0000355E  3803                    2947      MOVE.W  D3,D4
00003560  C8BC 0000F000           2948      AND.L   #$0000F000,D4
00003566  E95C                    2949      ROL.W   #4,D4 ;effective register
00003568                          2950      
00003568  143C 0010               2951      MOVE.B  #16,D2
0000356C  103C 000F               2952      MOVE.B  #15,D0
00003570                          2953      
00003570  6000 0002               2954      BRA     DETERMINE_MULS_AND
00003574                          2955      
00003574                          2956  DETERMINE_MULS_AND
00003574  BAFC 0007               2957      CMP.W   #%111,A5
00003578  6700 0176               2958      BEQ     DISPLAY_MULS
0000357C                          2959      
0000357C  6000 0002               2960      BRA     DISPLAY_AND
00003580                          2961  
00003580                          2962  
00003580                          2963  ;AND;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00003580                          2964  DISPLAY_AND 
00003580  43F9 00001125           2965      LEA     AND_OUTPUT,A1
00003586  103C 000E               2966      MOVE.B  #14,D0
0000358A  4E4F                    2967      TRAP    #15
0000358C                          2968      
0000358C  BAFC 0000               2969      CMP.W   #%000,A5
00003590  6700 002E               2970      BEQ     DISPLAY_BYTE_SRC_AND
00003594                          2971      
00003594  BAFC 0001               2972      CMP.W   #%001,A5
00003598  6700 0048               2973      BEQ     DISPLAY_WORD_SRC_AND
0000359C                          2974      
0000359C  BAFC 0002               2975      CMP.W   #%010,A5
000035A0  6700 0062               2976      BEQ     DISPLAY_LONG_SRC_AND
000035A4                          2977      
000035A4  BAFC 0004               2978      CMP.W   #%100,A5
000035A8  6700 007C               2979      BEQ     DISPLAY_BYTE_DEST_AND
000035AC                          2980      
000035AC  BAFC 0005               2981      CMP.W   #%101,A5
000035B0  6700 0096               2982      BEQ     DISPLAY_WORD_DEST_AND
000035B4                          2983      
000035B4  BAFC 0006               2984      CMP.W   #%110,A5
000035B8  6700 00B0               2985      BEQ     DISPLAY_LONG_DEST_AND
000035BC                          2986      
000035BC  6000 DB0C               2987      BRA     IF_INVALID_OP   
000035C0                          2988      
000035C0                          2989  DISPLAY_BYTE_SRC_AND
000035C0  43F9 0000117C           2990      LEA     B_OUTPUT,A1
000035C6  103C 000E               2991      MOVE.B  #14,D0
000035CA  4E4F                    2992      TRAP    #15
000035CC                          2993  
000035CC  6100 00BE               2994      BSR     GET_EFFECTIVE_ADDRESS_AND_SRC  
000035D0                          2995      
000035D0  123C 002C               2996      MOVE.B  #COMMA,D1
000035D4  103C 0006               2997      MOVE.B  #6,D0
000035D8  4E4F                    2998      TRAP    #15
000035DA                          2999      
000035DA  6100 E60E               3000      BSR     DISPLAY_Dn_ADD
000035DE                          3001      
000035DE  6000 DAFA               3002      BRA     ITERATE
000035E2                          3003  
000035E2                          3004  DISPLAY_WORD_SRC_AND
000035E2  43F9 00001180           3005      LEA     W_OUTPUT,A1
000035E8  103C 000E               3006      MOVE.B  #14,D0
000035EC  4E4F                    3007      TRAP    #15
000035EE                          3008  
000035EE  6100 009C               3009      BSR     GET_EFFECTIVE_ADDRESS_AND_SRC  
000035F2                          3010  
000035F2  123C 002C               3011      MOVE.B  #COMMA,D1
000035F6  103C 0006               3012      MOVE.B  #6,D0
000035FA  4E4F                    3013      TRAP    #15    
000035FC                          3014  
000035FC  6100 E5EC               3015      BSR     DISPLAY_Dn_ADD
00003600                          3016      
00003600  6000 DAD8               3017      BRA     ITERATE
00003604                          3018  
00003604                          3019  DISPLAY_LONG_SRC_AND
00003604  43F9 00001184           3020      LEA     L_OUTPUT,A1
0000360A  103C 000E               3021      MOVE.B  #14,D0
0000360E  4E4F                    3022      TRAP    #15
00003610                          3023  
00003610  6100 007A               3024      BSR     GET_EFFECTIVE_ADDRESS_AND_SRC  
00003614                          3025  
00003614  123C 002C               3026      MOVE.B  #COMMA,D1
00003618  103C 0006               3027      MOVE.B  #6,D0
0000361C  4E4F                    3028      TRAP    #15    
0000361E                          3029  
0000361E  6100 E5CA               3030      BSR     DISPLAY_Dn_ADD
00003622                          3031      
00003622  6000 DAB6               3032      BRA     ITERATE
00003626                          3033  
00003626                          3034  DISPLAY_BYTE_DEST_AND
00003626  43F9 0000117C           3035      LEA     B_OUTPUT,A1
0000362C  103C 000E               3036      MOVE.B  #14,D0
00003630  4E4F                    3037      TRAP    #15
00003632                          3038  
00003632  6100 E5B6               3039      BSR     DISPLAY_Dn_ADD
00003636                          3040      
00003636  123C 002C               3041      MOVE.B  #COMMA,D1
0000363A  103C 0006               3042      MOVE.B  #6,D0
0000363E  4E4F                    3043      TRAP    #15    
00003640                          3044  
00003640  6100 E5C0               3045      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00003644                          3046      
00003644  6000 DA94               3047      BRA     ITERATE
00003648                          3048  
00003648                          3049  DISPLAY_WORD_DEST_AND
00003648  43F9 00001180           3050      LEA     W_OUTPUT,A1
0000364E  103C 000E               3051      MOVE.B  #14,D0
00003652  4E4F                    3052      TRAP    #15
00003654                          3053  
00003654  6100 E594               3054      BSR     DISPLAY_Dn_ADD
00003658                          3055      
00003658  123C 002C               3056      MOVE.B  #COMMA,D1
0000365C  103C 0006               3057      MOVE.B  #6,D0
00003660  4E4F                    3058      TRAP    #15    
00003662                          3059  
00003662  6100 E59E               3060      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00003666                          3061      
00003666  6000 DA72               3062      BRA     ITERATE
0000366A                          3063  
0000366A                          3064  DISPLAY_LONG_DEST_AND
0000366A  43F9 00001184           3065      LEA     L_OUTPUT,A1
00003670  103C 000E               3066      MOVE.B  #14,D0
00003674  4E4F                    3067      TRAP    #15
00003676                          3068  
00003676  6100 E572               3069      BSR     DISPLAY_Dn_ADD
0000367A                          3070      
0000367A  123C 002C               3071      MOVE.B  #COMMA,D1
0000367E  103C 0006               3072      MOVE.B  #6,D0
00003682  4E4F                    3073      TRAP    #15    
00003684                          3074  
00003684  6100 E57C               3075      BSR     GET_EFFECTIVE_ADDRESS_ea_DEST 
00003688                          3076      
00003688  6000 DA50               3077      BRA     ITERATE
0000368C                          3078  
0000368C                          3079  GET_EFFECTIVE_ADDRESS_AND_SRC   
0000368C  BCFC 0000               3080      CMP.W   #%000,A6
00003690  6700 E28A               3081      BEQ     DISPLAY_Dn_ea
00003694                          3082  
00003694  BCFC 0002               3083      CMP.W   #%010,A6
00003698  6700 E2B2               3084      BEQ     DISPLAY_An_ADDRESS_ea
0000369C                          3085      
0000369C  BCFC 0003               3086      CMP.W   #%011,A6
000036A0  6700 E2D6               3087      BEQ     DISPLAY_An_ADDRESS_INCREMENT_ea
000036A4                          3088      
000036A4  BCFC 0004               3089      CMP.W   #%100,A6
000036A8  6700 E304               3090      BEQ     DISPLAY_An_ADDRESS_DECREMENT_ea
000036AC                          3091      
000036AC  BCFC 0007               3092      CMP.W   #%111,A6
000036B0  6700 0006               3093      BEQ     DISPLAY_ADDRESS_OR_DATA_AND_SRC
000036B4                          3094      
000036B4  6000 DA14               3095      BRA     IF_INVALID_OP
000036B8                          3096  
000036B8                          3097  DISPLAY_ADDRESS_OR_DATA_AND_SRC
000036B8  B87C 0000               3098      CMP.W   #%000,D4
000036BC  6700 E342               3099      BEQ     DISPLAY_ADDRESS_WORD_ea
000036C0                          3100      
000036C0  B87C 0001               3101      CMP.W   #%001,D4
000036C4  6700 E356               3102      BEQ     DISPLAY_ADDRESS_LONG_ea
000036C8                          3103      
000036C8  B87C 0004               3104      CMP.W   #%100,D4
000036CC  6700 0006               3105      BEQ     DISPLAY_DATA_ea_AND_SRC
000036D0                          3106      
000036D0  6000 D9F8               3107      BRA     IF_INVALID_OP
000036D4                          3108  
000036D4                          3109  DISPLAY_DATA_ea_AND_SRC
000036D4  BAFC 0000               3110      CMP.W   #%000,A5
000036D8  6700 E36E               3111      BEQ     DISPLAY_DATA_BYTE_ea
000036DC                          3112  
000036DC  BAFC 0001               3113      CMP.W   #%001,A5
000036E0  6700 E38C               3114      BEQ     DISPLAY_DATA_WORD_ea
000036E4                          3115      
000036E4  BAFC 0002               3116      CMP.W   #%010,A5
000036E8  6700 E3AA               3117      BEQ     DISPLAY_DATA_LONG_ea
000036EC                          3118  
000036EC  6000 D9DC               3119      BRA     IF_INVALID_OP
000036F0                          3120  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000036F0                          3121  
000036F0                          3122  
000036F0                          3123  ;MULS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
000036F0                          3124  DISPLAY_MULS
000036F0  43F9 00001129           3125      LEA     MULS_OUTPUT,A1
000036F6  103C 000E               3126      MOVE.B  #14,D0
000036FA  4E4F                    3127      TRAP    #15
000036FC  6000 D9CC               3128      BRA     IF_INVALID_OP
00003700                          3129      
00003700  43F9 00001180           3130      LEA     W_OUTPUT,A1
00003706  103C 000E               3131      MOVE.B  #14,D0
0000370A  4E4F                    3132      TRAP    #15
0000370C  6000 D9BC               3133      BRA     IF_INVALID_OP
00003710                          3134      
00003710  6100 FF7A               3135      BSR     GET_EFFECTIVE_ADDRESS_AND_SRC
00003714                          3136      
00003714  123C 002C               3137      MOVE.B  #COMMA,D1
00003718  103C 0006               3138      MOVE.B  #6,D0
0000371C  4E4F                    3139      TRAP    #15 
0000371E                          3140      
0000371E  6100 E4CA               3141      BSR     DISPLAY_Dn_ADD
00003722                          3142      
00003722  6000 D9B6               3143      BRA     ITERATE
00003726                          3144      
00003726                          3145      
00003726                          3146      
00003726                          3147      
00003726                          3148  
00003726                          3149  
00003726                          3150  
00003726                          3151  
00003726                          3152  
00003726                          3153  -------------------- end include --------------------
00003726                          3154          
00001000                          3155  START   ORG    $1000
00001000                          3156  
00001000                          3157      ; first instruction of program
00001000                          3158      
00001000                          3159      ;TODO: put in an actual line counter 
00001000  247C 00006000           3160      MOVE.L  #$6000,A2
00001006  267C 00007000           3161      MOVE.L  #$7000,A3
0000100C  6000 00DE               3162      BRA     COMPARE
00001010                          3163  
00001010                          3164  ;Parses Simple Commands, such as NOP     
00001010                          3165  PARSE_SIMPLE    
00001010                          3166      
00001010  3852                    3167      MOVE.W  (A2),A4
00001012                          3168      
00001012  B8FC 4E71               3169      CMP.W   #NOP_CODE,A4
00001016  6700 007A               3170      BEQ     IF_NOP 
0000101A                          3171      
0000101A  B8FC 4E75               3172      CMP.W   #RTS_CODE,A4
0000101E  6700 0082               3173      BEQ     IF_RTS
00001022                          3174      
00001022  6000 0002               3175      BRA     PARSE_COMPLEX
00001026                          3176  
00001026                          3177  ; For parsing more complex commands
00001026                          3178  PARSE_COMPLEX
00001026  3A4C                    3179      MOVE.W  A4,A5
00001028  360C                    3180      MOVE.W  A4,D3
0000102A                          3181      
0000102A  C67C F000               3182      AND.W   #$F000,D3
0000102E                          3183      
0000102E  B67C 1000               3184      CMP.W   #MOVE_B_CODE,D3
00001032  6700 007E               3185      BEQ     IF_MOVE_B
00001036                          3186  
00001036  B67C 3000               3187      CMP.W   #MOVE_W_CODE,D3
0000103A  6700 007E               3188      BEQ     IF_MOVE_W
0000103E                          3189      
0000103E  B67C 2000               3190      CMP.W   #MOVE_L_CODE,D3
00001042  6700 007E               3191      BEQ     IF_MOVE_L
00001046                          3192      
00001046  B67C D000               3193      CMP.W   #ADD_CODE,D3
0000104A  6700 07F4               3194      BEQ     IF_ADD_ADDA
0000104E                          3195      
0000104E  B67C 9000               3196      CMP.W   #SUB_CODE,D3
00001052  6700 28EC               3197      BEQ     IF_SUB
00001056                          3198      
00001056  B67C 5000               3199      CMP.W   #ADDQ_CODE,D3
0000105A  6700 0C04               3200      BEQ     IF_ADDQ
0000105E                          3201      
0000105E  B67C C000               3202      CMP.W   #MULS_AND_CODE,D3
00001062  6700 24BC               3203      BEQ     IF_MULS_AND
00001066                          3204      
00001066  B67C 8000               3205      CMP.W   #DIVU_OR_CODE,D3
0000106A  6700 1434               3206      BEQ     IF_DIVU_OR
0000106E                          3207      
0000106E  B67C 4000               3208      CMP.W   #MISC_CODE,D3
00001072  6700 1C6C               3209      BEQ     IF_MISC
00001076                          3210      
00001076  B67C 7000               3211      CMP.W   #MOVEQ_CODE,D3
0000107A  6700 2084               3212      BEQ     IF_MOVEQ
0000107E                          3213      
0000107E  B67C 6000               3214      CMP.W   #Bcc_BRA_CODE,D3
00001082  6700 0FFC               3215      BEQ     IF_Bcc_BRA
00001086                          3216      
00001086  B67C E000               3217      CMP.W   #LS_CODE,D3
0000108A  6700 1834               3218      BEQ     IF_LS_CODE
0000108E                          3219      
0000108E  6000 003A               3220      BRA     IF_INVALID_OP
00001092                          3221      
00001092                          3222  IF_NOP
00001092  43F9 000010FC           3223      LEA     NOP_OUTPUT,A1
00001098  103C 000E               3224      MOVE.B  #14,D0
0000109C  4E4F                    3225      TRAP    #15
0000109E  6000 003A               3226      BRA     ITERATE
000010A2                          3227  
000010A2                          3228  IF_RTS
000010A2  43F9 00001102           3229      LEA     RTS_OUTPUT,A1
000010A8  103C 000E               3230      MOVE.B  #14,D0
000010AC  4E4F                    3231      TRAP    #15
000010AE  6000 002A               3232      BRA     ITERATE
000010B2                          3233  
000010B2                          3234  IF_MOVE_B
000010B2  3A3C 1000               3235      MOVE.W  #MOVE_B_CODE,D5
000010B6  6000 0368               3236      BRA     PARSE_MOVE
000010BA                          3237  
000010BA                          3238  IF_MOVE_W
000010BA  3A3C 3000               3239      MOVE.W  #MOVE_W_CODE,D5
000010BE  6000 0360               3240      BRA     PARSE_MOVE
000010C2                          3241  
000010C2                          3242  IF_MOVE_L
000010C2  3A3C 2000               3243      MOVE.W  #MOVE_L_CODE,D5
000010C6  6000 0358               3244      BRA     PARSE_MOVE
000010CA                          3245  
000010CA                          3246  IF_INVALID_OP
000010CA  43F9 00001188           3247      LEA     INVALID_OUTPUT,A1
000010D0  103C 000E               3248      MOVE.B  #14,D0
000010D4  4E4F                    3249      TRAP    #15
000010D6  6000 001E               3250      BRA     DONE
000010DA                          3251  
000010DA                          3252  ITERATE
000010DA  548A                    3253      ADDQ.L  #2,A2
000010DC                          3254      
000010DC  43F9 0000119D           3255      LEA     NEWLINE,A1
000010E2  103C 000E               3256      MOVE.B  #14,D0
000010E6  4E4F                    3257      TRAP    #15
000010E8                          3258      
000010E8  6000 0002               3259      BRA     COMPARE
000010EC                          3260      
000010EC                          3261  COMPARE    
000010EC  B4CB                    3262      CMP     A3,A2     
000010EE  6C00 0006               3263      BGE     DONE
000010F2  6000 FF1C               3264      BRA     PARSE_SIMPLE
000010F6                          3265  
000010F6                          3266  DONE
000010F6  103C 0009               3267      MOVE.B  #9,D0
000010FA  4E4F                    3268      TRAP    #15
000010FC                          3269  
000010FC                          3270  * Put variables and constants here
000010FC                          3271  
000010FC  =0000000D               3272  CR              EQU     $0D
000010FC  =0000000A               3273  LF              EQU     $0A
000010FC  =00000028               3274  LEFT_PAR        EQU     $28
000010FC  =00000029               3275  RIGHT_PAR       EQU     $29
000010FC  =00000041               3276  A               EQU     $41
000010FC  =00000044               3277  D               EQU     $44
000010FC  =0000002B               3278  PLUS            EQU     $2B
000010FC  =0000002D               3279  MINUS           EQU     $2D
000010FC  =00000023               3280  NUM             EQU     $23
000010FC  =00000024               3281  HEX             EQU     $24
000010FC  =0000002C               3282  COMMA           EQU     $2C
000010FC  =00000020               3283  SPACE           EQU     $20
000010FC  =0000002F               3284  SLASH           EQU     $2F
000010FC                          3285  
000010FC                          3286  ;Codes to be parsed
000010FC  =00004E71               3287  NOP_CODE        EQU     $4E71
000010FC  =00004E75               3288  RTS_CODE        EQU     $4E75
000010FC  =00001000               3289  MOVE_B_CODE     EQU     $1000 ; MOVE.B, MOVEA.B (done)
000010FC  =00003000               3290  MOVE_W_CODE     EQU     $3000 ; MOVE.W, MOVEA.W (done)
000010FC  =00002000               3291  MOVE_L_CODE     EQU     $2000 ; MOVE.L, MOVEA.L (done)
000010FC  =00007000               3292  MOVEQ_CODE      EQU     $7000 ; MOVEQ (done)
000010FC  =00008000               3293  DIVU_OR_CODE    EQU     $8000 ; [DIVU], OR (done)
000010FC  =00009000               3294  SUB_CODE        EQU     $9000 ; SUB (done)
000010FC  =0000C000               3295  MULS_AND_CODE   EQU     $C000 ; MULS, AND (done)
000010FC  =0000D000               3296  ADD_CODE        EQU     $D000 ; ADD, ADDA (done)
000010FC  =0000E000               3297  LS_CODE         EQU     $E000 ; LOGICAL SHIFTS (in progress)
000010FC  =00005000               3298  ADDQ_CODE       EQU     $5000 ; ADDQ (done)
000010FC  =00006000               3299  Bcc_BRA_CODE    EQU     $6000 ; Bcc (BGT, BLE, BEQ), BRA
000010FC  =00004000               3300  MISC_CODE       EQU     $4000 ; LEA, NOT, JSR, MOVEM (LEA, NOT, JSR done)
000010FC                          3301  
000010FC                          3302  
000010FC  =0000E4C0               3303  LSR_ADDRESS     EQU     $E4C0
000010FC  =0000E5C0               3304  LSL_ADDRESS     EQU     $E5C0
000010FC  =0000E0C0               3305  ASR_ADDRESS     EQU     $E0C0
000010FC  =0000E1C0               3306  ASL_ADDRESS     EQU     $E1C0
000010FC  =0000E6C0               3307  ROR_ADDRESS     EQU     $E6C0
000010FC  =0000E7C0               3308  ROL_ADDRESS     EQU     $E7C0
000010FC                          3309  
000010FC  =0000E01A               3310  LSR_REGISTER    EQU     $E01A
000010FC  =0000E11A               3311  LSL_REGISTER    EQU     $E11A
000010FC  =0000E00A               3312  ASR_REGISTER    EQU     $E00A
000010FC  =0000E10A               3313  ASL_REGISTER    EQU     $E10A
000010FC  =0000E6C0               3314  ROR_REGISTER    EQU     $E6C0
000010FC  =0000E7C0               3315  ROL_REGISTER    EQU     $E7C0
000010FC                          3316  
000010FC                          3317  ;Sample outputs
000010FC= 4E 4F 50 0D 0A 00       3318  NOP_OUTPUT      DC.B    'NOP',CR,LF,0
00001102= 52 54 53 0D 0A 00       3319  RTS_OUTPUT      DC.B    'RTS',CR,LF,0
00001108                          3320  
00001108= 4D 4F 56 45 41 00       3321  MOVEA_OUTPUT    DC.B    'MOVEA',0
0000110E= 4D 4F 56 45 00          3322  MOVE_OUTPUT     DC.B    'MOVE',0
00001113= 41 44 44 41 00          3323  ADDA_OUTPUT     DC.B    'ADDA',0
00001118= 41 44 44 00             3324  ADD_OUTPUT      DC.B    'ADD',0
0000111C= 53 55 42 00             3325  SUB_OUTPUT      DC.B    'SUB',0
00001120= 41 44 44 51 00          3326  ADDQ_OUTPUT     DC.B    'ADDQ',0
00001125= 41 4E 44 00             3327  AND_OUTPUT      DC.B    'AND',0
00001129= 4D 55 4C 53 00          3328  MULS_OUTPUT     DC.B    'MULS',0
0000112E= 4F 52 00                3329  OR_OUTPUT       DC.B    'OR',0
00001131= 44 49 56 55 00          3330  DIVU_OUTPUT     DC.B    'DIVU',0
00001136= 4E 4F 54 00             3331  NOT_OUTPUT      DC.B    'NOT',0
0000113A= 4A 53 52 20 00          3332  JSR_OUTPUT      DC.B    'JSR ',0
0000113F= 4C 45 41 00             3333  LEA_OUTPUT      DC.B    'LEA',0
00001143= 4D 4F 56 45 51 20 00    3334  MOVEQ_OUTPUT    DC.B    'MOVEQ ',0
0000114A= 4D 4F 56 45 4D 00       3335  MOVEM_OUTPUT    DC.B    'MOVEM',0
00001150                          3336  
00001150= 42 52 41 20 00          3337  BRA_OUTPUT      DC.B    'BRA ',0
00001155= 42 47 45 20 00          3338  BGT_OUTPUT      DC.B    'BGE ',0
0000115A= 42 4C 45 20 00          3339  BLE_OUTPUT      DC.B    'BLE ',0
0000115F= 42 45 51 20 00          3340  BEQ_OUTPUT      DC.B    'BEQ ',0
00001164                          3341  
00001164= 4C 53 52 00             3342  LSR_OUTPUT      DC.B    'LSR',0
00001168= 4C 53 4C 00             3343  LSL_OUTPUT      DC.B    'LSL',0
0000116C= 41 53 52 00             3344  ASR_OUTPUT      DC.B    'ASR',0
00001170= 41 53 4C 00             3345  ASL_OUTPUT      DC.B    'ASL',0
00001174= 52 4F 52 00             3346  ROR_OUTPUT      DC.B    'ROR',0
00001178= 52 4F 4C 00             3347  ROL_OUTPUT      DC.B    'ROL',0
0000117C                          3348  
0000117C= 2E 42 20 00             3349  B_OUTPUT        DC.B    '.B ',0
00001180= 2E 57 20 00             3350  W_OUTPUT        DC.B    '.W ',0
00001184= 2E 4C 20 00             3351  L_OUTPUT        DC.B    '.L ',0
00001188                          3352  
00001188= 49 6E 76 61 6C 69 ...   3353  INVALID_OUTPUT  DC.B    'Invalid operation!',CR,LF,0
0000119D= 0D 0A 00                3354  NEWLINE         DC.B    CR,LF,0
000011A0                          3355  
000011A0                          3356              END    START        ; last line of source

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
A                   41
ADDA_OUTPUT         1113
ADDQ_CODE           5000
ADDQ_OUTPUT         1120
ADD_CODE            D000
ADD_OUTPUT          1118
AND_OUTPUT          1125
ASL_ADDRESS         E1C0
ASL_OUTPUT          1170
ASL_REGISTER        E10A
ASR_ADDRESS         E0C0
ASR_OUTPUT          116C
ASR_REGISTER        E00A
BCC_BRA_CODE        6000
BEQ_OUTPUT          115F
BGT_OUTPUT          1155
BLE_OUTPUT          115A
BRA_OUTPUT          1150
B_OUTPUT            117C
CHECK_FOR_EIGHT     1D8E
CHECK_IF_0          2B38
COMMA               2C
COMPARE             10EC
CR                  D
D                   44
DETERMINE_DIVU_OR   24F4
DETERMINE_MULS_AND  3574
DETERMINE_SRC       2AAC
DISPLAY_A0          3FA8
DISPLAY_A0_ADDRESS  42B8
DISPLAY_A1          3FC2
DISPLAY_A1_ADDRESS  42D2
DISPLAY_A2          3FDC
DISPLAY_A2_ADDRESS  42EC
DISPLAY_A3          3FF6
DISPLAY_A3_ADDRESS  4306
DISPLAY_A4          4010
DISPLAY_A4_ADDRESS  4320
DISPLAY_A5          402A
DISPLAY_A5_ADDRESS  433A
DISPLAY_A6          4044
DISPLAY_A6_ADDRESS  4354
DISPLAY_A7          405E
DISPLAY_A7_ADDRESS  436E
DISPLAY_ADD         1ADA
DISPLAY_ADDA_L      18C8
DISPLAY_ADDA_REGISTER  1AB6
DISPLAY_ADDA_W      18A8
DISPLAY_ADDQ        1CB8
DISPLAY_ADDQ_BYTE   1CE4
DISPLAY_ADDQ_COMMA  1D14
DISPLAY_ADDQ_LONG   1D04
DISPLAY_ADDQ_SIZE   1CC8
DISPLAY_ADDQ_WORD   1CF4
DISPLAY_ADDRESS_EA  1D7A
DISPLAY_ADDRESS_LONG_DEST  1816
DISPLAY_ADDRESS_LONG_EA  1A1C
DISPLAY_ADDRESS_LONG_NOT  2F30
DISPLAY_ADDRESS_LONG_SRC  1628
DISPLAY_ADDRESS_OR_DATA_AND_SRC  36B8
DISPLAY_ADDRESS_OR_DATA_DEST  17E4
DISPLAY_ADDRESS_OR_DATA_EA  19E4
DISPLAY_ADDRESS_OR_DATA_NOT  2F00
DISPLAY_ADDRESS_OR_DATA_SRC  15EE
DISPLAY_ADDRESS_WORD_DEST  17F8
DISPLAY_ADDRESS_WORD_EA  1A00
DISPLAY_ADDRESS_WORD_NOT  2F14
DISPLAY_ADDRESS_WORD_SRC  160A
DISPLAY_ADD_ADDA    1894
DISPLAY_AND         3580
DISPLAY_AN_ADDRESS_DECREMENT_EA  19AE
DISPLAY_AN_ADDRESS_DECREMENT_NOT  2ECA
DISPLAY_AN_ADDRESS_EA  194C
DISPLAY_AN_ADDRESS_INCREMENT_EA  1978
DISPLAY_AN_ADDRESS_INCREMENT_NOT  2E94
DISPLAY_AN_ADDRESS_NOT  2E68
DISPLAY_AN_DEST     172C
DISPLAY_AN_EA       1934
DISPLAY_AN_SRC      1536
DISPLAY_ARGS        1AEA
DISPLAY_AT_AN_DECREMENT_DEST  17AC
DISPLAY_AT_AN_DECREMENT_SRC  15B6
DISPLAY_AT_AN_DEST  1746
DISPLAY_AT_AN_INCREMENT_DEST  1774
DISPLAY_AT_AN_INCREMENT_SRC  157E
DISPLAY_AT_AN_SRC   1550
DISPLAY_BEQ         2108
DISPLAY_BGT         20BC
DISPLAY_BLE         20E2
DISPLAY_BRA         20AA
DISPLAY_BYTE        14B8
DISPLAY_BYTE_DEST   1B84
DISPLAY_BYTE_DEST_AND  3626
DISPLAY_BYTE_DEST_OR  25AE
DISPLAY_BYTE_SRC    1B1E
DISPLAY_BYTE_SRC_AND  35C0
DISPLAY_BYTE_SRC_OR  2548
DISPLAY_D0          3ED8
DISPLAY_D0_ADDRESS  41E8
DISPLAY_D1          3EF2
DISPLAY_D1_ADDRESS  4202
DISPLAY_D2          3F0C
DISPLAY_D2_ADDRESS  421C
DISPLAY_D3          3F26
DISPLAY_D3_ADDRESS  4236
DISPLAY_D4          3F40
DISPLAY_D4_ADDRESS  4250
DISPLAY_D5          3F5A
DISPLAY_D5_ADDRESS  426A
DISPLAY_D6          3F74
DISPLAY_D6_ADDRESS  4284
DISPLAY_D7          3F8E
DISPLAY_D7_ADDRESS  429E
DISPLAY_DATA_BYTE_EA  1A48
DISPLAY_DATA_EA     1A34
DISPLAY_DATA_EA_AND_SRC  36D4
DISPLAY_DATA_LONG_EA  1A94
DISPLAY_DATA_SRC    1642
DISPLAY_DATA_SRC_BYTE  165E
DISPLAY_DATA_SRC_LONG  16B0
DISPLAY_DATA_SRC_WORD  1688
DISPLAY_DATA_WORD_EA  1A6E
DISPLAY_DEST        16D4
DISPLAY_DISPLACEMENT_AS_ADDRESS  2172
DISPLAY_DIVU        2640
DISPLAY_DN_ADD      1BEA
DISPLAY_DN_DEST     1712
DISPLAY_DN_EA       191C
DISPLAY_DN_NOT      2E50
DISPLAY_DN_SRC      151C
DISPLAY_EA_JSR_LEA  2F48
DISPLAY_EA_NOT      2E24
DISPLAY_EA_TO_ADDRESS  408C
DISPLAY_EA_TO_REGISTER  3E0C
DISPLAY_EFFECTIVE_ADDRESS  29A8
DISPLAY_LONG        14D8
DISPLAY_LONG_DEST   1BC8
DISPLAY_LONG_DEST_AND  366A
DISPLAY_LONG_DEST_OR  25F2
DISPLAY_LONG_SRC    1B62
DISPLAY_LONG_SRC_AND  3604
DISPLAY_LONG_SRC_OR  258C
DISPLAY_MOVE        148C
DISPLAY_MOVEA       147C
DISPLAY_MOVEQ       3112
DISPLAY_MULS        36F0
DISPLAY_NOT_BYTE    2D4A
DISPLAY_NOT_LONG    2D8E
DISPLAY_NOT_WORD    2D6C
DISPLAY_NUM         2AE6
DISPLAY_OR          2508
DISPLAY_REG         3E54
DISPLAY_REGISTER_1  2ACC
DISPLAY_REGISTER_2  2B0E
DISPLAY_REG_ADDRESS  4164
DISPLAY_SIZE_BYTE   2A7C
DISPLAY_SIZE_LONG   2A9C
DISPLAY_SIZE_WORD   2A8C
DISPLAY_SRC_MODE    14E8
DISPLAY_SUB         3994
DISPLAY_TYPE        149C
DISPLAY_WORD        14C8
DISPLAY_WORD_DEST   1BA6
DISPLAY_WORD_DEST_AND  3648
DISPLAY_WORD_DEST_OR  25D0
DISPLAY_WORD_SRC    1B40
DISPLAY_WORD_SRC_AND  35E2
DISPLAY_WORD_SRC_OR  256A
DIVU_OR_CODE        8000
DIVU_OUTPUT         1131
DONE                10F6
DRAW_SLASH          43B0
END_PARSER          3E52
GET_EFFECTIVE_ADDRESS_AND_SRC  368C
GET_EFFECTIVE_ADDRESS_EA  18E8
GET_EFFECTIVE_ADDRESS_EA_DEST  1C02
GET_EFFECTIVE_ADDRESS_EA_NO_DATA  1D46
GET_EFFECTIVE_ADDRESS_OR_SRC  2614
GET_MASK_ADDRESS    4118
GET_SIZE            2A58
GET_WORD_OR_LONG    29E4
HEX                 24
IF_ADDQ             1C60
IF_ADD_ADDA         1840
IF_ASL_ADDRESS      296C
IF_ASL_REGISTER     2A28
IF_ASR_ADDRESS      2958
IF_ASR_REGISTER     2A18
IF_BCC_BRA          2080
IF_DIVU_L           2E20
IF_DIVU_OR          24A0
IF_DRAW_SLASH       439C
IF_DRAW_SLASH_2     43A6
IF_INVALID_OP       10CA
IF_JSR              2DB0
IF_LEA              2DD2
IF_LSL_ADDRESS      2944
IF_LSL_REGISTER     2A08
IF_LSR_ADDRESS      2930
IF_LSR_REGISTER     29F8
IF_LS_CODE          28C0
IF_MISC             2CE0
IF_MOVEM            3D60
IF_MOVEM_TO_ADDRESS  40B6
IF_MOVEM_TO_REGISTER  3D7A
IF_MOVEQ            3100
IF_MOVE_B           10B2
IF_MOVE_L           10C2
IF_MOVE_W           10BA
IF_MULS_AND         3520
IF_MULS_L           2E1C
IF_NEGATIVE_BYTE    215A
IF_NEGATIVE_WORD    2166
IF_NOP              1092
IF_NOT              2D1C
IF_ROL_ADDRESS      2994
IF_ROL_REGISTER     2A48
IF_ROR_ADDRESS      2980
IF_ROR_REGISTER     2A38
IF_RTS              10A2
IF_SUB              3940
INVALID_OUTPUT      1188
ITERATE             10DA
ITERATE_MASK        4076
ITERATE_MASK_ADDRESS  4386
JSR_OUTPUT          113A
LEA_OUTPUT          113F
LEFT_PAR            28
LF                  A
LOAD_MASK_ADDRESS   4130
LONG_FOR_TO_ADDRESS  40F6
LONG_FOR_TO_REGISTER  3DD2
LSL_ADDRESS         E5C0
LSL_OUTPUT          1168
LSL_REGISTER        E11A
LSR_ADDRESS         E4C0
LSR_OUTPUT          1164
LSR_REGISTER        E01A
LS_CODE             E000
L_OUTPUT            1184
MINUS               2D
MISC_CODE           4000
MOVEA_OUTPUT        1108
MOVEM_OUTPUT        114A
MOVEQ_CODE          7000
MOVEQ_OUTPUT        1143
MOVE_B_CODE         1000
MOVE_L_CODE         2000
MOVE_OUTPUT         110E
MOVE_W_CODE         3000
MULS_AND_CODE       C000
MULS_OUTPUT         1129
NEWLINE             119D
NOP_CODE            4E71
NOP_OUTPUT          10FC
NOT_OUTPUT          1136
NUM                 23
OR_OUTPUT           112E
PARSE_COMPLEX       1026
PARSE_DISPLACEMENT_BYTE  212E
PARSE_DISPLACEMENT_WORD  2142
PARSE_MASK          3E36
PARSE_MASK_ADDRESS  4148
PARSE_MOVE          1420
PARSE_SIMPLE        1010
PLUS                2B
RIGHT_PAR           29
ROL_ADDRESS         E7C0
ROL_OUTPUT          1178
ROL_REGISTER        E7C0
ROR_ADDRESS         E6C0
ROR_OUTPUT          1174
ROR_REGISTER        E6C0
RTS_CODE            4E75
RTS_OUTPUT          1102
SET_TO_EIGHT        1D98
SET_TO_ZERO         2B42
SLASH               2F
SPACE               20
START               1000
SUB_CODE            9000
SUB_OUTPUT          111C
WORD_FOR_TO_ADDRESS  40D6
WORD_FOR_TO_REGISTER  3D98
W_OUTPUT            1180
